# æ°´é¢æ¹–é¢åƒåœ¾åˆ†ç±»æ£€æµ‹æ£€æµ‹ç³»ç»Ÿæºç åˆ†äº«
 # [ä¸€æ¡é¾™æ•™å­¦YOLOV8æ ‡æ³¨å¥½çš„æ•°æ®é›†ä¸€é”®è®­ç»ƒ_70+å…¨å¥—æ”¹è¿›åˆ›æ–°ç‚¹å‘åˆŠ_Webå‰ç«¯å±•ç¤º]

### 1.ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

é¡¹ç›®å‚è€ƒ[AAAI Association for the Advancement of Artificial Intelligence](https://gitee.com/qunmasj/projects)

é¡¹ç›®æ¥æº[AACV Association for the Advancement of Computer Vision](https://kdocs.cn/l/cszuIiCKVNis)

ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

éšç€åŸå¸‚åŒ–è¿›ç¨‹çš„åŠ å¿«å’Œäººä»¬ç”Ÿæ´»æ°´å¹³çš„æé«˜ï¼Œæ°´é¢å’Œæ¹–é¢åƒåœ¾é—®é¢˜æ—¥ç›Šä¸¥é‡ï¼Œç»™ç”Ÿæ€ç¯å¢ƒå’Œæ°´èµ„æºå®‰å…¨å¸¦æ¥äº†æå¤§çš„å¨èƒã€‚æ°´é¢åƒåœ¾ä¸ä»…å½±å“æ°´ä½“çš„ç¾è§‚ï¼Œè¿˜å¯¹æ°´ç”Ÿç”Ÿç‰©çš„ç”Ÿå­˜å’Œç”Ÿæ€ç³»ç»Ÿçš„å¹³è¡¡é€ æˆäº†è´Ÿé¢å½±å“ã€‚æ ¹æ®ç›¸å…³ç ”ç©¶ï¼Œæ°´é¢åƒåœ¾çš„å­˜åœ¨å¯èƒ½å¯¼è‡´æ°´è´¨æ¶åŒ–ï¼Œè¿›è€Œå½±å“äººç±»çš„é¥®æ°´å®‰å…¨å’Œå¥åº·ã€‚å› æ­¤ï¼ŒåŠæ—¶ã€å‡†ç¡®åœ°è¯†åˆ«å’Œåˆ†ç±»æ°´é¢åƒåœ¾ï¼Œæˆä¸ºäº†ç¯å¢ƒä¿æŠ¤é¢†åŸŸäºŸå¾…è§£å†³çš„é‡è¦è¯¾é¢˜ã€‚

è¿‘å¹´æ¥ï¼Œè®¡ç®—æœºè§†è§‰æŠ€æœ¯çš„å¿«é€Ÿå‘å±•ä¸ºåƒåœ¾æ£€æµ‹ä¸åˆ†ç±»æä¾›äº†æ–°çš„è§£å†³æ–¹æ¡ˆã€‚YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—æ¨¡å‹å› å…¶é«˜æ•ˆçš„å®æ—¶æ£€æµ‹èƒ½åŠ›ï¼Œå·²è¢«å¹¿æ³›åº”ç”¨äºç‰©ä½“æ£€æµ‹ä»»åŠ¡ä¸­ã€‚YOLOv8ä½œä¸ºè¯¥ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå…·æœ‰æ›´é«˜çš„æ£€æµ‹ç²¾åº¦å’Œæ›´å¿«çš„å¤„ç†é€Ÿåº¦ï¼Œé€‚åˆåœ¨å¤æ‚ç¯å¢ƒä¸­è¿›è¡Œåƒåœ¾æ£€æµ‹ã€‚ç„¶è€Œï¼Œé’ˆå¯¹æ°´é¢å’Œæ¹–é¢åƒåœ¾çš„æ£€æµ‹ä»»åŠ¡ï¼ŒYOLOv8ä»å­˜åœ¨ä¸€äº›æŒ‘æˆ˜ï¼Œä¾‹å¦‚èƒŒæ™¯å¤æ‚æ€§ã€å…‰ç…§å˜åŒ–ä»¥åŠåƒåœ¾ç§ç±»çš„å¤šæ ·æ€§ç­‰ã€‚å› æ­¤ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„æ°´é¢æ¹–é¢åƒåœ¾åˆ†ç±»æ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶ï¼Œå…·æœ‰é‡è¦çš„ç†è®ºä»·å€¼å’Œå®è·µæ„ä¹‰ã€‚

æœ¬ç ”ç©¶çš„æ ¸å¿ƒåœ¨äºæ„å»ºä¸€ä¸ªåŸºäºæ”¹è¿›YOLOv8çš„åƒåœ¾åˆ†ç±»æ£€æµ‹ç³»ç»Ÿï¼Œæ—¨åœ¨æé«˜æ°´é¢å’Œæ¹–é¢åƒåœ¾çš„æ£€æµ‹ç²¾åº¦å’Œåˆ†ç±»æ•ˆç‡ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªåŒ…å«1800å¼ å›¾åƒçš„æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†æ¶µç›–äº†å››ç±»åƒåœ¾ï¼šç“¶å­ã€çº¸ç®±ã€çº¸å¼ å’Œå¡‘æ–™ã€‚è¿™äº›ç±»åˆ«çš„é€‰æ‹©ä¸ä»…åæ˜ äº†æ°´é¢åƒåœ¾çš„å¸¸è§ç±»å‹ï¼Œä¹Ÿä¸ºæ¨¡å‹çš„è®­ç»ƒå’Œè¯„ä¼°æä¾›äº†ä¸°å¯Œçš„æ ·æœ¬ã€‚é€šè¿‡å¯¹æ•°æ®é›†çš„æ·±å…¥åˆ†æï¼Œæˆ‘ä»¬å°†æ¢ç´¢ä¸åŒç±»åˆ«åƒåœ¾çš„ç‰¹å¾å’Œåˆ†å¸ƒè§„å¾‹ï¼Œä»¥ä¾¿ä¸ºæ¨¡å‹çš„æ”¹è¿›æä¾›ä¾æ®ã€‚

åœ¨ç ”ç©¶è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†é’ˆå¯¹YOLOv8æ¨¡å‹è¿›è¡Œä¸€ç³»åˆ—æ”¹è¿›ï¼ŒåŒ…æ‹¬ä¼˜åŒ–ç½‘ç»œç»“æ„ã€è°ƒæ•´è¶…å‚æ•°ã€å¼•å…¥æ•°æ®å¢å¼ºæŠ€æœ¯ç­‰ï¼Œä»¥æé«˜æ¨¡å‹åœ¨æ°´é¢åƒåœ¾æ£€æµ‹ä¸­çš„è¡¨ç°ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å°†ç»“åˆå›¾åƒå¤„ç†æŠ€æœ¯ï¼Œæå‡å›¾åƒçš„è´¨é‡å’Œå¯è¯†åˆ«æ€§ï¼Œä»è€Œå¢å¼ºæ¨¡å‹å¯¹å¤æ‚èƒŒæ™¯å’Œå…‰ç…§å˜åŒ–çš„é€‚åº”èƒ½åŠ›ã€‚é€šè¿‡è¿™äº›æ”¹è¿›ï¼Œæˆ‘ä»¬æœŸæœ›èƒ½å¤Ÿå®ç°å¯¹æ°´é¢åƒåœ¾çš„é«˜æ•ˆæ£€æµ‹å’Œå‡†ç¡®åˆ†ç±»ï¼Œä¸ºåç»­çš„åƒåœ¾æ¸…ç†å’Œç¯å¢ƒä¿æŠ¤å·¥ä½œæä¾›æŠ€æœ¯æ”¯æŒã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„æ°´é¢æ¹–é¢åƒåœ¾åˆ†ç±»æ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶ï¼Œä¸ä»…æœ‰åŠ©äºæ¨åŠ¨è®¡ç®—æœºè§†è§‰æŠ€æœ¯åœ¨ç¯å¢ƒä¿æŠ¤é¢†åŸŸçš„åº”ç”¨ï¼Œä¹Ÿä¸ºæ°´ä½“ç”Ÿæ€ç¯å¢ƒçš„ä¿æŠ¤æä¾›äº†æ–°çš„æ€è·¯å’Œæ–¹æ³•ã€‚é€šè¿‡å®ç°é«˜æ•ˆçš„åƒåœ¾æ£€æµ‹ä¸åˆ†ç±»ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä¸ºæ°´é¢åƒåœ¾çš„æ²»ç†æä¾›ç§‘å­¦ä¾æ®ï¼Œä¿ƒè¿›å¯æŒç»­å‘å±•ç›®æ ‡çš„å®ç°ã€‚å¸Œæœ›æœ¬ç ”ç©¶èƒ½å¤Ÿä¸ºç›¸å…³é¢†åŸŸçš„ç ”ç©¶è€…æä¾›å‚è€ƒï¼Œæ¨åŠ¨æ°´é¢åƒåœ¾æ²»ç†æŠ€æœ¯çš„è¿›æ­¥ï¼Œæœ€ç»ˆå®ç°æ°´ä½“ç¯å¢ƒçš„æ”¹å–„å’Œç”Ÿæ€ç³»ç»Ÿçš„æ¢å¤ã€‚

### 2.å›¾ç‰‡æ¼”ç¤º

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ2.å›¾ç‰‡æ¼”ç¤ºâ€å’Œâ€œ3.è§†é¢‘æ¼”ç¤ºâ€å±•ç¤ºçš„ç³»ç»Ÿå›¾ç‰‡æˆ–è€…è§†é¢‘å¯èƒ½ä¸ºè€ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬åœ¨è€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šå‡çº§å¦‚ä¸‹ï¼šï¼ˆå®é™…æ•ˆæœä»¥å‡çº§çš„æ–°ç‰ˆæœ¬ä¸ºå‡†ï¼‰

  ï¼ˆ1ï¼‰é€‚é…äº†YOLOV8çš„â€œç›®æ ‡æ£€æµ‹â€æ¨¡å‹å’Œâ€œå®ä¾‹åˆ†å‰²â€æ¨¡å‹ï¼Œé€šè¿‡åŠ è½½ç›¸åº”çš„æƒé‡ï¼ˆ.ptï¼‰æ–‡ä»¶å³å¯è‡ªé€‚åº”åŠ è½½æ¨¡å‹ã€‚

  ï¼ˆ2ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«æ¨¡å¼ã€‚

  ï¼ˆ3ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«ç»“æœä¿å­˜å¯¼å‡ºï¼Œè§£å†³æ‰‹åŠ¨å¯¼å‡ºï¼ˆå®¹æ˜“å¡é¡¿å‡ºç°çˆ†å†…å­˜ï¼‰å­˜åœ¨çš„é—®é¢˜ï¼Œè¯†åˆ«å®Œè‡ªåŠ¨ä¿å­˜ç»“æœå¹¶å¯¼å‡ºåˆ°tempDirä¸­ã€‚

  ï¼ˆ4ï¼‰æ”¯æŒWebå‰ç«¯ç³»ç»Ÿä¸­çš„æ ‡é¢˜ã€èƒŒæ™¯å›¾ç­‰è‡ªå®šä¹‰ä¿®æ”¹ï¼Œåé¢æä¾›ä¿®æ”¹æ•™ç¨‹ã€‚

  å¦å¤–æœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,éœ€è¦æ‚¨æŒ‰ç…§æ•™ç¨‹è¿›è¡Œè®­ç»ƒåå®ç°å›¾ç‰‡æ¼”ç¤ºå’ŒWebå‰ç«¯ç•Œé¢æ¼”ç¤ºçš„æ•ˆæœã€‚

### 3.è§†é¢‘æ¼”ç¤º

[3.1 è§†é¢‘æ¼”ç¤º](https://www.bilibili.com/video/BV15RxjehEbK/)

### 4.æ•°æ®é›†ä¿¡æ¯å±•ç¤º

##### 4.1 æœ¬é¡¹ç›®æ•°æ®é›†è¯¦ç»†æ•°æ®ï¼ˆç±»åˆ«æ•°ï¼†ç±»åˆ«åï¼‰

nc: 4
names: ['bottle', 'carton', 'paper', 'plastic']


##### 4.2 æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æ•°æ®é›†ä¿¡æ¯å±•ç¤º

åœ¨æœ¬ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†åä¸ºâ€œtrashâ€çš„æ•°æ®é›†ï¼Œæ—¨åœ¨è®­ç»ƒå’Œæ”¹è¿›YOLOv8æ¨¡å‹ï¼Œä»¥å®ç°å¯¹æ°´é¢å’Œæ¹–é¢åƒåœ¾çš„é«˜æ•ˆåˆ†ç±»æ£€æµ‹ã€‚è¯¥æ•°æ®é›†ä¸“é—¨é’ˆå¯¹æ°´åŸŸç¯å¢ƒä¸­çš„å¸¸è§åƒåœ¾ç±»å‹è¿›è¡Œäº†ç²¾å¿ƒæ„å»ºï¼Œæ¶µç›–äº†å››ä¸ªä¸»è¦ç±»åˆ«ï¼Œåˆ†åˆ«æ˜¯ç“¶å­ã€çº¸ç®±ã€çº¸å¼ å’Œå¡‘æ–™ã€‚è¿™äº›ç±»åˆ«çš„é€‰æ‹©ä¸ä»…åæ˜ äº†æ°´åŸŸåƒåœ¾çš„å®é™…æƒ…å†µï¼Œä¹Ÿä¸ºæ¨¡å‹çš„è®­ç»ƒæä¾›äº†ä¸°å¯Œçš„æ ·æœ¬å’Œå¤šæ ·åŒ–çš„ç‰¹å¾ï¼Œä»è€Œæé«˜äº†æ£€æµ‹çš„å‡†ç¡®æ€§å’Œé²æ£’æ€§ã€‚

â€œtrashâ€æ•°æ®é›†çš„è®¾è®¡è€ƒè™‘åˆ°äº†å¤šç§å› ç´ ï¼Œä»¥ç¡®ä¿å…¶åœ¨å®é™…åº”ç”¨ä¸­çš„æœ‰æ•ˆæ€§ã€‚é¦–å…ˆï¼Œæ•°æ®é›†ä¸­çš„å›¾åƒé‡‡é›†è‡ªä¸åŒçš„æ°´åŸŸç¯å¢ƒï¼ŒåŒ…æ‹¬æ¹–æ³Šã€æ²³æµå’Œäººå·¥æ°´ä½“ï¼Œç¡®ä¿äº†æ•°æ®çš„å¤šæ ·æ€§å’Œä»£è¡¨æ€§ã€‚æ¯ä¸ªç±»åˆ«çš„æ ·æœ¬å‡åœ¨ä¸åŒçš„å…‰ç…§æ¡ä»¶ã€å¤©æ°”çŠ¶å†µå’Œæ°´é¢çŠ¶æ€ä¸‹è¿›è¡Œæ‹æ‘„ï¼Œä»¥æ¨¡æ‹ŸçœŸå®ä¸–ç•Œä¸­å¯èƒ½é‡åˆ°çš„å„ç§åœºæ™¯ã€‚è¿™ç§å¤šæ ·åŒ–çš„æ ·æœ¬ä¸ä»…æœ‰åŠ©äºæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œè¿˜èƒ½å¢å¼ºå…¶åœ¨å¤æ‚ç¯å¢ƒä¸­çš„è¡¨ç°ã€‚

åœ¨æ•°æ®æ ‡æ³¨æ–¹é¢ï¼Œæ•°æ®é›†é‡‡ç”¨äº†ç²¾ç¡®çš„æ ‡æ³¨æ–¹æ³•ï¼Œç¡®ä¿æ¯ä¸ªå›¾åƒä¸­çš„åƒåœ¾å¯¹è±¡éƒ½è¢«å‡†ç¡®åœ°æ¡†å®šå’Œåˆ†ç±»ã€‚æ ‡æ³¨è¿‡ç¨‹ä¸­ï¼Œä¸“ä¸šäººå‘˜å¯¹æ¯ä¸ªç±»åˆ«çš„ç‰¹å¾è¿›è¡Œäº†è¯¦ç»†åˆ†æï¼Œä»¥ç¡®ä¿æ ‡æ³¨çš„å‡†ç¡®æ€§å’Œä¸€è‡´æ€§ã€‚è¿™ç§é«˜è´¨é‡çš„æ ‡æ³¨ä¸ä»…ä¸ºæ¨¡å‹çš„è®­ç»ƒæä¾›äº†å¯é çš„åŸºç¡€ï¼Œä¹Ÿä¸ºåç»­çš„æ¨¡å‹è¯„ä¼°å’Œæ€§èƒ½åˆ†æå¥ å®šäº†è‰¯å¥½çš„åŸºç¡€ã€‚

æ­¤å¤–ï¼Œæ•°æ®é›†çš„æ„å»ºè¿˜å……åˆ†è€ƒè™‘äº†æ•°æ®çš„å¹³è¡¡æ€§ã€‚æ¯ä¸ªç±»åˆ«çš„æ ·æœ¬æ•°é‡ç»è¿‡ç²¾å¿ƒè®¾è®¡ï¼Œä»¥é¿å…æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å‡ºç°åå€šç°è±¡ã€‚é€šè¿‡ç¡®ä¿æ¯ä¸ªç±»åˆ«çš„æ ·æœ¬æ•°é‡ç›¸å¯¹å‡è¡¡ï¼Œæ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°å­¦ä¹ åˆ°å„ç±»åƒåœ¾çš„ç‰¹å¾ï¼Œä»è€Œåœ¨å®é™…åº”ç”¨ä¸­å®ç°æ›´é«˜çš„åˆ†ç±»ç²¾åº¦ã€‚

åœ¨æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†â€œtrashâ€æ•°æ®é›†ä¸YOLOv8æ¨¡å‹ç›¸ç»“åˆï¼Œåˆ©ç”¨å…¶å¼ºå¤§çš„ç‰¹å¾æå–èƒ½åŠ›å’Œå®æ—¶æ£€æµ‹æ€§èƒ½ï¼Œè¿›è¡Œäº†ä¸€ç³»åˆ—å®éªŒã€‚é€šè¿‡å¯¹æ•°æ®é›†çš„æ·±å…¥åˆ†æå’Œæ¨¡å‹å‚æ•°çš„ä¼˜åŒ–ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä¸æ–­æå‡æ¨¡å‹åœ¨æ°´é¢åƒåœ¾åˆ†ç±»æ£€æµ‹ä»»åŠ¡ä¸­çš„è¡¨ç°ã€‚å®éªŒç»“æœè¡¨æ˜ï¼Œç»è¿‡è®­ç»ƒçš„YOLOv8æ¨¡å‹åœ¨å¯¹æ°´é¢åƒåœ¾çš„æ£€æµ‹å’Œåˆ†ç±»æ–¹é¢å–å¾—äº†æ˜¾è‘—çš„è¿›å±•ï¼Œèƒ½å¤Ÿæœ‰æ•ˆè¯†åˆ«å‡ºä¸åŒç±»å‹çš„åƒåœ¾ï¼Œå¹¶åœ¨å®æ—¶ç›‘æµ‹ä¸­è¡¨ç°å‡ºè‰¯å¥½çš„ç¨³å®šæ€§å’Œå‡†ç¡®æ€§ã€‚

æ€»ä¹‹ï¼Œâ€œtrashâ€æ•°æ®é›†ä¸ºæœ¬ç ”ç©¶æä¾›äº†åšå®çš„åŸºç¡€ï¼Œå‡­å€Ÿå…¶ä¸°å¯Œçš„æ ·æœ¬ã€å¤šæ ·çš„ç¯å¢ƒå’Œé«˜è´¨é‡çš„æ ‡æ³¨ï¼Œæå¤§åœ°æ¨åŠ¨äº†æ°´é¢æ¹–é¢åƒåœ¾åˆ†ç±»æ£€æµ‹ç³»ç»Ÿçš„å¼€å‘ä¸ä¼˜åŒ–ã€‚æœªæ¥ï¼Œæˆ‘ä»¬å°†ç»§ç»­æ¢ç´¢æ•°æ®é›†çš„æ‰©å±•å’Œæ”¹è¿›ï¼Œä»¥è¿›ä¸€æ­¥æå‡æ¨¡å‹çš„æ€§èƒ½ï¼Œä¸ºæ°´åŸŸç¯å¢ƒä¿æŠ¤å’Œåƒåœ¾ç®¡ç†æä¾›æ›´ä¸ºæœ‰æ•ˆçš„æŠ€æœ¯æ”¯æŒã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®ç¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404473917358506534?logTag=c807d0cbc21c0ef59de5)




[5.2 å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404474678003106304?logTag=1f1041108cd1f708b01a)

### 6.æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰

[6.1 æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰](https://www.ixigua.com/7404477157818401292?logTag=d31a2dfd1983c9668658)

### 7.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰

[7.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰](https://www.ixigua.com/7404478314661806627?logTag=29066f8288e3f4eea3a4)

### 8.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£ï¼ˆéç§‘ç­ä¹Ÿå¯ä»¥è½»æ¾å†™åˆŠå‘åˆŠï¼ŒV10ç‰ˆæœ¬æ­£åœ¨ç§‘ç ”å¾…æ›´æ–°ï¼‰

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŸç†è®²è§£å°±ä¸ä¸€ä¸€å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„åˆ›æ–°ç‚¹å¯¹åº”å­é¡¹ç›®çš„æŠ€æœ¯åŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼š

![9.png](9.png)

[8.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£é“¾æ¥](https://gitee.com/qunmasj/good)

### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤ºï¼ˆæ£€æµ‹å¯¹è±¡ä¸ºä¸¾ä¾‹ï¼Œå®é™…å†…å®¹ä»¥æœ¬é¡¹ç›®æ•°æ®é›†ä¸ºå‡†ï¼‰

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒè·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®æ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10.åŸå§‹YOLOV8ç®—æ³•åŸç†

åŸå§‹YOLOv8ç®—æ³•åŸç†

YOLOv8ä½œä¸ºYOLOç³»åˆ—ä¸­çš„æœ€æ–°ç‰ˆæœ¬ï¼Œç»§æ‰¿å¹¶å‘å±•äº†å‰å‡ ä»£ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³ï¼Œæ—¨åœ¨å®ç°æ›´é«˜æ•ˆçš„ç›®æ ‡æ£€æµ‹ã€‚å…¶è®¾è®¡ç†å¿µåŸºäºæ·±åº¦å­¦ä¹ çš„å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰ï¼Œé€šè¿‡ä¼˜åŒ–ç½‘ç»œç»“æ„å’Œç®—æ³•æµç¨‹ï¼Œæå‡äº†ç›®æ ‡æ£€æµ‹çš„ç²¾åº¦å’Œé€Ÿåº¦ã€‚YOLOv8çš„åŸºæœ¬æ¶æ„ç”±è¾“å…¥ç«¯ã€ä¸»å¹²ç½‘ç»œã€Neckç«¯å’Œè¾“å‡ºç«¯å››ä¸ªæ¨¡å—ç»„æˆï¼Œæ¯ä¸ªæ¨¡å—éƒ½åœ¨ä¸åŒå±‚é¢ä¸Šè¿›è¡Œäº†åˆ›æ–°å’Œæ”¹è¿›ï¼Œä»¥é€‚åº”ç°ä»£è®¡ç®—æœºè§†è§‰çš„éœ€æ±‚ã€‚

åœ¨è¾“å…¥ç«¯ï¼ŒYOLOv8é‡‡ç”¨äº†å¤šç§æ•°æ®å¢å¼ºæŠ€æœ¯ï¼Œå¦‚Mosaicæ•°æ®å¢å¼ºã€è‡ªé€‚åº”å›¾ç‰‡ç¼©æ”¾å’Œç°åº¦å¡«å……ç­‰ï¼Œä»¥æé«˜æ¨¡å‹å¯¹ä¸åŒè¾“å…¥å›¾åƒçš„é€‚åº”èƒ½åŠ›ã€‚è¿™äº›æŠ€æœ¯ä¸ä»…å¢å¼ºäº†è®­ç»ƒæ•°æ®çš„å¤šæ ·æ€§ï¼Œè¿˜æœ‰æ•ˆåœ°æé«˜äº†æ¨¡å‹çš„é²æ£’æ€§ï¼Œä½¿å…¶åœ¨é¢å¯¹å¤æ‚åœºæ™¯æ—¶ä¾ç„¶èƒ½å¤Ÿä¿æŒè¾ƒé«˜çš„æ£€æµ‹æ€§èƒ½ã€‚

ä¸»å¹²ç½‘ç»œæ˜¯YOLOv8çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œå…¶ä¸»è¦ä»»åŠ¡æ˜¯ä»è¾“å…¥å›¾åƒä¸­æå–ç‰¹å¾ã€‚YOLOv8å¼•å…¥äº†C2Fæ¨¡å—ï¼Œå–ä»£äº†ä¼ ç»Ÿçš„C3æ¨¡å—ï¼Œé‡‡ç”¨äº†æ›´è½»é‡åŒ–çš„3Ã—3å·ç§¯ï¼Œæ·±åº¦è®¾ç½®ä¸º3ã€6ã€6ã€3ã€‚è¿™ç§è®¾è®¡æ˜¾è‘—é™ä½äº†è®¡ç®—å¤æ‚åº¦ï¼ŒåŒæ—¶ä¿æŒäº†ç‰¹å¾æå–çš„æœ‰æ•ˆæ€§ã€‚é€šè¿‡ä½¿ç”¨C2Fæ¨¡å—ï¼ŒYOLOv8èƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰å›¾åƒä¸­çš„é‡è¦ç‰¹å¾ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å°ç›®æ ‡æ—¶ï¼Œèƒ½å¤Ÿæœ‰æ•ˆå‡å°‘ä¿¡æ¯æŸå¤±ã€‚

åœ¨ç‰¹å¾èåˆå±‚ï¼ŒYOLOv8é‡‡ç”¨äº†ç‰¹å¾é‡‘å­—å¡”ç½‘ç»œï¼ˆFPNï¼‰å’Œè·¯å¾„èšåˆç½‘ç»œï¼ˆPANï¼‰çš„ç»“åˆï¼Œè¿›ä¸€æ­¥æå‡äº†å¯¹ä¸åŒå°ºåº¦ç‰¹å¾çš„æå–èƒ½åŠ›ã€‚ç‰¹å¾é‡‘å­—å¡”ç½‘ç»œé€šè¿‡æ„å»ºå¤šå±‚æ¬¡çš„ç‰¹å¾å›¾ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿåœ¨ä¸åŒçš„å°ºåº¦ä¸Šè¿›è¡Œç‰¹å¾èåˆï¼Œä»è€Œæé«˜äº†å¯¹ç›®æ ‡çš„æ£€æµ‹ç²¾åº¦ã€‚è€Œè·¯å¾„èšåˆç½‘ç»œåˆ™é€šè¿‡ä¸Šé‡‡æ ·å’Œä¸‹é‡‡æ ·çš„ç»“åˆï¼Œå¢å¼ºäº†ç‰¹å¾å›¾ä¹‹é—´çš„ä¿¡æ¯æµåŠ¨ï¼Œä½¿å¾—æ¨¡å‹åœ¨å¤„ç†å¤æ‚åœºæ™¯æ—¶èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚

YOLOv8çš„æ£€æµ‹å¤´å±‚é‡‡ç”¨äº†è½»é‡åŒ–çš„è§£è€¦å¤´ï¼Œå–ä»£äº†ä¼ ç»Ÿçš„è€¦åˆå¤´ç»“æ„ã€‚è¿™ä¸€åˆ›æ–°ä½¿å¾—åˆ†ç±»å’Œå›å½’è¿‡ç¨‹å¾—ä»¥åˆ†å¼€å¤„ç†ï¼Œæå‡äº†æ¨¡å‹çš„æ£€æµ‹æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚åœ¨è§£è€¦å¤´çš„è®¾è®¡ä¸­ï¼ŒYOLOv8å¼•å…¥äº†æœ‰é”™ç›®æ ‡æ£€æµ‹çš„æ–¹æ³•ï¼Œå–ä»£äº†æ— é”šç›®æ ‡æ£€æµ‹çš„æ–¹å¼ï¼Œè¿™ä¸€å˜åŒ–ä½¿å¾—æ¨¡å‹åœ¨å¤æ‚èƒŒæ™¯ä¸‹çš„ç›®æ ‡å®šä½èƒ½åŠ›å¾—åˆ°äº†æ˜¾è‘—æå‡ã€‚

YOLOv8çš„å¦ä¸€ä¸ªé‡è¦åˆ›æ–°æ˜¯å¼•å…¥äº†BiFPNç½‘ç»œï¼Œè¿™ä¸€ç»“æ„é€šè¿‡é«˜æ•ˆçš„åŒå‘è·¨å°ºåº¦è¿æ¥å’ŒåŠ æƒç‰¹å¾èåˆï¼Œè¿›ä¸€æ­¥æé«˜äº†æ¨¡å‹å¯¹ä¸åŒå°ºåº¦ç‰¹å¾ä¿¡æ¯çš„æå–é€Ÿåº¦ã€‚BiFPNçš„è®¾è®¡ç†å¿µæ˜¯é€šè¿‡ç®€åŒ–ç‰¹å¾å›¾ä¹‹é—´çš„è¿æ¥æ–¹å¼ï¼Œå‡å°‘å†—ä½™è®¡ç®—ï¼Œä»è€ŒåŠ å¿«ç‰¹å¾èåˆçš„é€Ÿåº¦ã€‚è¿™ä¸€æ”¹è¿›ä½¿å¾—YOLOv8åœ¨å¤„ç†å¤šå°ºåº¦ç›®æ ‡æ—¶è¡¨ç°å¾—æ›´åŠ å‡ºè‰²ï¼Œå°¤å…¶æ˜¯åœ¨å°ç›®æ ‡æ£€æµ‹æ–¹é¢ï¼Œèƒ½å¤Ÿæœ‰æ•ˆé™ä½æ¼æ£€ç‡ã€‚

åœ¨æŸå¤±å‡½æ•°çš„è®¾è®¡ä¸Šï¼ŒYOLOv8é‡‡ç”¨äº†TaskAlignedAssigneræ–¹æ³•ï¼Œå¯¹åˆ†ç±»åˆ†æ•°å’Œå›å½’åˆ†æ•°è¿›è¡ŒåŠ æƒåŒ¹é…ï¼Œç¡®ä¿æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èƒ½å¤Ÿæ›´å¥½åœ°å­¦ä¹ åˆ°ç›®æ ‡çš„ç‰¹å¾ã€‚åˆ†ç±»æŸå¤±ä½¿ç”¨äº†äºŒå…ƒäº¤å‰ç†µï¼ˆBCEï¼‰ï¼Œè€Œå›å½’æŸå¤±åˆ™é‡‡ç”¨äº†åˆ†å¸ƒç„¦ç‚¹æŸå¤±ï¼ˆDFLï¼‰å’Œå®Œå…¨äº¤å¹¶æ¯”ï¼ˆCIoUï¼‰æŸå¤±å‡½æ•°ã€‚è¿™äº›æŸå¤±å‡½æ•°çš„è®¾è®¡ä½¿å¾—YOLOv8åœ¨ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­èƒ½å¤Ÿæ›´å¥½åœ°å¹³è¡¡ç²¾åº¦å’Œå¬å›ç‡ï¼Œæé«˜äº†æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚

å°½ç®¡YOLOv8åœ¨è®¸å¤šæ–¹é¢éƒ½å–å¾—äº†æ˜¾è‘—çš„è¿›å±•ï¼Œä½†åœ¨å¤æ‚æ°´é¢ç¯å¢ƒä¸‹çš„åº”ç”¨ä»ç„¶é¢ä¸´æŒ‘æˆ˜ã€‚å°ç›®æ ‡æ¼‚æµ®ç‰©çš„ç‰¹å¾å¤æ‚ä¸”èƒŒæ™¯å¤šæ ·ï¼Œå¯¼è‡´YOLOv8åœ¨å®šä½å’Œæ„ŸçŸ¥èƒ½åŠ›ä¸Šå­˜åœ¨ä¸€å®šçš„ä¸è¶³ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œç ”ç©¶è€…ä»¬æå‡ºäº†YOLOv8-WSSODç®—æ³•ï¼Œé€šè¿‡å¼•å…¥BiFormeråŒå±‚è·¯ç”±æ³¨æ„åŠ›æœºåˆ¶ï¼Œæ„å»ºC2fBFæ¨¡å—ï¼Œä»¥æ•è·è¿œç¨‹ä¾èµ–ï¼Œä¿ç•™æ›´ç»†ç²’åº¦çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚æ­¤å¤–ï¼Œé’ˆå¯¹å°ç›®æ ‡æ¼æ£€é—®é¢˜ï¼ŒYOLOv8-WSSODè¿˜æ·»åŠ äº†æ›´å°çš„æ£€æµ‹å¤´ï¼Œå¹¶åœ¨Neckç«¯å¼•å…¥GSConvå’ŒSlim-neckæŠ€æœ¯ï¼Œä»¥æé«˜æ¨¡å‹çš„æ£€æµ‹ç²¾åº¦å’Œé™ä½è®¡ç®—é‡ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒYOLOv8é€šè¿‡å¯¹ç½‘ç»œç»“æ„çš„ä¼˜åŒ–å’Œç®—æ³•æµç¨‹çš„æ”¹è¿›ï¼Œå±•ç°äº†å…¶åœ¨ç›®æ ‡æ£€æµ‹é¢†åŸŸçš„å¼ºå¤§èƒ½åŠ›ã€‚å…¶è½»é‡åŒ–è®¾è®¡å’Œé«˜æ•ˆçš„ç‰¹å¾æå–èƒ½åŠ›ï¼Œä½¿å¾—YOLOv8èƒ½å¤Ÿåœ¨å„ç§å¤æ‚åœºæ™¯ä¸­å®ç°å¿«é€Ÿã€å‡†ç¡®çš„ç›®æ ‡æ£€æµ‹ã€‚éšç€æŠ€æœ¯çš„ä¸æ–­è¿›æ­¥ï¼ŒYOLOv8æ— ç–‘å°†åœ¨æ™ºèƒ½ç›‘æ§ã€è‡ªåŠ¨é©¾é©¶ã€äººè„¸è¯†åˆ«ç­‰å¤šä¸ªåº”ç”¨é¢†åŸŸå‘æŒ¥é‡è¦ä½œç”¨ã€‚

![18.png](18.png)

### 11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰

#### 11.1 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\models\nas\model.py

ä»¥ä¸‹æ˜¯å¯¹ä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†è¿›è¡Œçš„æç‚¼å’Œè¯¦ç»†ä¸­æ–‡æ³¨é‡Šï¼š

```python
# Ultralytics YOLO ğŸš€, AGPL-3.0 license
"""
YOLO-NASæ¨¡å‹æ¥å£ã€‚

ç¤ºä¾‹ï¼š
    ```python
    from ultralytics import NAS

    model = NAS('yolo_nas_s')
    results = model.predict('ultralytics/assets/bus.jpg')
    ```
"""

from pathlib import Path
import torch
from ultralytics.engine.model import Model
from ultralytics.utils.torch_utils import model_info, smart_inference_mode
from .predict import NASPredictor
from .val import NASValidator

class NAS(Model):
    """
    YOLO NASæ¨¡å‹ç”¨äºç›®æ ‡æ£€æµ‹ã€‚

    è¯¥ç±»æä¾›YOLO-NASæ¨¡å‹çš„æ¥å£ï¼Œå¹¶æ‰©å±•äº†Ultralyticså¼•æ“ä¸­çš„`Model`ç±»ã€‚
    å®ƒæ—¨åœ¨ç®€åŒ–ä½¿ç”¨é¢„è®­ç»ƒæˆ–è‡ªå®šä¹‰è®­ç»ƒçš„YOLO-NASæ¨¡å‹è¿›è¡Œç›®æ ‡æ£€æµ‹çš„ä»»åŠ¡ã€‚

    å±æ€§ï¼š
        model (str): é¢„è®­ç»ƒæ¨¡å‹çš„è·¯å¾„æˆ–æ¨¡å‹åç§°ã€‚é»˜è®¤ä¸º'yolo_nas_s.pt'ã€‚

    æ³¨æ„ï¼š
        YOLO-NASæ¨¡å‹ä»…æ”¯æŒé¢„è®­ç»ƒæ¨¡å‹ã€‚è¯·å‹¿æä¾›YAMLé…ç½®æ–‡ä»¶ã€‚
    """

    def __init__(self, model='yolo_nas_s.pt') -> None:
        """ä½¿ç”¨æä¾›çš„æˆ–é»˜è®¤çš„'yolo_nas_s.pt'æ¨¡å‹åˆå§‹åŒ–NASæ¨¡å‹ã€‚"""
        # ç¡®ä¿æä¾›çš„æ¨¡å‹æ–‡ä»¶ä¸æ˜¯YAMLæ ¼å¼
        assert Path(model).suffix not in ('.yaml', '.yml'), 'YOLO-NASæ¨¡å‹ä»…æ”¯æŒé¢„è®­ç»ƒæ¨¡å‹ã€‚'
        # è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•
        super().__init__(model, task='detect')

    @smart_inference_mode()
    def _load(self, weights: str, task: str):
        """åŠ è½½ç°æœ‰çš„NASæ¨¡å‹æƒé‡ï¼Œæˆ–å¦‚æœæœªæä¾›ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„NASæ¨¡å‹å¹¶ä½¿ç”¨é¢„è®­ç»ƒæƒé‡ã€‚"""
        import super_gradients
        suffix = Path(weights).suffix
        # æ ¹æ®æƒé‡æ–‡ä»¶çš„åç¼€åŠ è½½æ¨¡å‹
        if suffix == '.pt':
            self.model = torch.load(weights)  # åŠ è½½.ptæ–‡ä»¶
        elif suffix == '':
            self.model = super_gradients.training.models.get(weights, pretrained_weights='coco')  # è·å–é¢„è®­ç»ƒæ¨¡å‹

        # æ ‡å‡†åŒ–æ¨¡å‹
        self.model.fuse = lambda verbose=True: self.model  # å®šä¹‰èåˆæ–¹æ³•
        self.model.stride = torch.tensor([32])  # è®¾ç½®æ­¥å¹…
        self.model.names = dict(enumerate(self.model._class_names))  # è®¾ç½®ç±»åˆ«åç§°
        self.model.is_fused = lambda: False  # è¿”å›æ¨¡å‹æ˜¯å¦å·²èåˆ
        self.model.yaml = {}  # åˆå§‹åŒ–yamlå±æ€§
        self.model.pt_path = weights  # è®¾ç½®æƒé‡è·¯å¾„
        self.model.task = 'detect'  # è®¾ç½®ä»»åŠ¡ç±»å‹

    def info(self, detailed=False, verbose=True):
        """
        è®°å½•æ¨¡å‹ä¿¡æ¯ã€‚

        å‚æ•°ï¼š
            detailed (bool): æ˜¯å¦æ˜¾ç¤ºæ¨¡å‹çš„è¯¦ç»†ä¿¡æ¯ã€‚
            verbose (bool): æ§åˆ¶è¾“å‡ºçš„è¯¦ç»†ç¨‹åº¦ã€‚
        """
        return model_info(self.model, detailed=detailed, verbose=verbose, imgsz=640)

    @property
    def task_map(self):
        """è¿”å›ä¸€ä¸ªå­—å…¸ï¼Œå°†ä»»åŠ¡æ˜ å°„åˆ°ç›¸åº”çš„é¢„æµ‹å™¨å’ŒéªŒè¯å™¨ç±»ã€‚"""
        return {'detect': {'predictor': NASPredictor, 'validator': NASValidator}}
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†åˆ†æï¼š
1. **ç±»å®šä¹‰**ï¼š`NAS`ç±»ç»§æ‰¿è‡ª`Model`ç±»ï¼Œä¸“é—¨ç”¨äºYOLO-NASæ¨¡å‹çš„ç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚
2. **åˆå§‹åŒ–æ–¹æ³•**ï¼š`__init__`æ–¹æ³•ç¡®ä¿ä¼ å…¥çš„æ¨¡å‹æ–‡ä»¶æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•ã€‚
3. **åŠ è½½æ¨¡å‹**ï¼š`_load`æ–¹æ³•æ ¹æ®æƒé‡æ–‡ä»¶çš„åç¼€åŠ è½½æ¨¡å‹ï¼Œæ”¯æŒ`.pt`æ–‡ä»¶å’Œæ— åç¼€çš„æ¨¡å‹åç§°ã€‚
4. **æ¨¡å‹ä¿¡æ¯**ï¼š`info`æ–¹æ³•ç”¨äºè®°å½•å’Œè¾“å‡ºæ¨¡å‹çš„ç›¸å…³ä¿¡æ¯ï¼Œä¾¿äºç”¨æˆ·äº†è§£æ¨¡å‹çš„é…ç½®ã€‚
5. **ä»»åŠ¡æ˜ å°„**ï¼š`task_map`å±æ€§è¿”å›ä¸€ä¸ªå­—å…¸ï¼ŒæŒ‡æ˜äº†ä¸åŒä»»åŠ¡å¯¹åº”çš„é¢„æµ‹å™¨å’ŒéªŒè¯å™¨ç±»ï¼Œä¾¿äºæ‰©å±•å’Œç®¡ç†ä¸åŒçš„ä»»åŠ¡ã€‚

è¿™äº›æ ¸å¿ƒéƒ¨åˆ†æ„æˆäº†YOLO-NASæ¨¡å‹çš„åŸºæœ¬åŠŸèƒ½ï¼Œæ”¯æŒç›®æ ‡æ£€æµ‹ä»»åŠ¡çš„å®ç°ã€‚

è¯¥æ–‡ä»¶æ˜¯YOLO-NASæ¨¡å‹çš„æ¥å£å®ç°ï¼Œå±äºUltralytics YOLOç³»åˆ—çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œä¸»è¦ç”¨äºç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚æ–‡ä»¶ä¸­é¦–å…ˆå¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“å’Œæ¨¡å—ï¼ŒåŒ…æ‹¬`Path`ç”¨äºå¤„ç†æ–‡ä»¶è·¯å¾„ï¼Œ`torch`ç”¨äºæ·±åº¦å­¦ä¹ æ¡†æ¶PyTorchçš„æ“ä½œï¼Œä»¥åŠä»Ultralyticså¼•æ“ä¸­å¯¼å…¥çš„`Model`ç±»å’Œä¸€äº›å·¥å…·å‡½æ•°ã€‚

åœ¨æ–‡ä»¶çš„å¼€å¤´ï¼Œæœ‰ä¸€ä¸ªç®€çŸ­çš„æ–‡æ¡£å­—ç¬¦ä¸²ï¼Œè¯´æ˜äº†å¦‚ä½•ä½¿ç”¨è¿™ä¸ªæ¨¡å‹ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡å¯¼å…¥`NAS`ç±»å¹¶å®ä¾‹åŒ–ä¸€ä¸ªæ¨¡å‹å¯¹è±¡æ¥è¿›è¡Œç›®æ ‡æ£€æµ‹ï¼Œç¤ºä¾‹ä»£ç å±•ç¤ºäº†å¦‚ä½•åŠ è½½ä¸€ä¸ªé¢„è®­ç»ƒçš„YOLO-NASæ¨¡å‹å¹¶å¯¹ä¸€å¼ å›¾ç‰‡è¿›è¡Œé¢„æµ‹ã€‚

æ¥ä¸‹æ¥å®šä¹‰äº†`NAS`ç±»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ª`Model`ç±»ï¼Œä¸“é—¨ç”¨äºYOLO-NASæ¨¡å‹çš„å®ç°ã€‚æ„é€ å‡½æ•°`__init__`æ¥å—ä¸€ä¸ªå‚æ•°`model`ï¼Œé»˜è®¤å€¼ä¸º'yolo_nas_s.pt'ï¼Œå¹¶ç¡®ä¿ä¼ å…¥çš„æ¨¡å‹è·¯å¾„ä¸æ˜¯ä»¥`.yaml`æˆ–`.yml`ç»“å°¾ï¼Œå› ä¸ºYOLO-NASæ¨¡å‹åªæ”¯æŒé¢„è®­ç»ƒæ¨¡å‹ï¼Œè€Œä¸æ”¯æŒé…ç½®æ–‡ä»¶ã€‚

`_load`æ–¹æ³•ç”¨äºåŠ è½½æ¨¡å‹æƒé‡ã€‚å¦‚æœä¼ å…¥çš„æƒé‡æ–‡ä»¶æ˜¯`.pt`æ ¼å¼ï¼Œåˆ™ç›´æ¥åŠ è½½è¯¥æ–‡ä»¶ï¼›å¦‚æœæ²¡æœ‰åç¼€ï¼Œåˆ™å°è¯•ä»`super_gradients`åº“ä¸­è·å–é¢„è®­ç»ƒæ¨¡å‹ã€‚è¯¥æ–¹æ³•è¿˜å¯¹æ¨¡å‹è¿›è¡Œäº†ä¸€äº›æ ‡å‡†åŒ–å¤„ç†ï¼ŒåŒ…æ‹¬è®¾ç½®æ¨¡å‹çš„æ­¥å¹…ã€ç±»åˆ«åç§°ç­‰å±æ€§ã€‚

`info`æ–¹æ³•ç”¨äºè®°å½•æ¨¡å‹çš„ä¿¡æ¯ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©æ˜¯å¦æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯å’Œæ§åˆ¶è¾“å‡ºçš„è¯¦ç»†ç¨‹åº¦ã€‚

æœ€åï¼Œ`task_map`å±æ€§è¿”å›ä¸€ä¸ªå­—å…¸ï¼Œå°†ä»»åŠ¡æ˜ å°„åˆ°ç›¸åº”çš„é¢„æµ‹å™¨å’ŒéªŒè¯å™¨ç±»ï¼Œä¾¿äºåœ¨ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­ä½¿ç”¨ã€‚

æ•´ä½“æ¥çœ‹ï¼Œè¯¥æ–‡ä»¶æä¾›äº†ä¸€ä¸ªç®€æ´çš„æ¥å£ï¼Œæ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨YOLO-NASæ¨¡å‹è¿›è¡Œç›®æ ‡æ£€æµ‹ï¼Œå¹¶ä¸”åŒ…å«äº†å¿…è¦çš„æ¨¡å‹åŠ è½½å’Œä¿¡æ¯æŸ¥è¯¢åŠŸèƒ½ã€‚

#### 11.2 code\ultralytics\utils\instance.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import numpy as np

class Bboxes:
    """
    å¤„ç†è¾¹ç•Œæ¡†çš„ç±»ï¼Œæ”¯æŒå¤šç§è¾¹ç•Œæ¡†æ ¼å¼ï¼ˆå¦‚ 'xyxy', 'xywh', 'ltwh'ï¼‰ã€‚
    """

    def __init__(self, bboxes, format="xyxy") -> None:
        """
        åˆå§‹åŒ– Bboxes ç±»ï¼Œæ¥æ”¶è¾¹ç•Œæ¡†æ•°æ®å’Œæ ¼å¼ã€‚
        
        å‚æ•°:
            bboxes (numpy.ndarray): è¾¹ç•Œæ¡†æ•°æ®ï¼Œå½¢çŠ¶ä¸º [N, 4]ã€‚
            format (str): è¾¹ç•Œæ¡†æ ¼å¼ï¼Œé»˜è®¤ä¸º 'xyxy'ã€‚
        """
        # ç¡®ä¿æ ¼å¼æœ‰æ•ˆ
        assert format in _formats, f"æ— æ•ˆçš„è¾¹ç•Œæ¡†æ ¼å¼: {format}, æ ¼å¼å¿…é¡»æ˜¯ {_formats} ä¸­çš„ä¸€ç§"
        # å¦‚æœ bboxes æ˜¯ä¸€ç»´æ•°ç»„ï¼Œåˆ™æ·»åŠ ä¸€ä¸ªç»´åº¦
        bboxes = bboxes[None, :] if bboxes.ndim == 1 else bboxes
        # ç¡®ä¿ bboxes æ˜¯äºŒç»´æ•°ç»„ï¼Œä¸”æ¯ä¸ªè¾¹ç•Œæ¡†æœ‰ 4 ä¸ªåæ ‡
        assert bboxes.ndim == 2
        assert bboxes.shape[1] == 4
        self.bboxes = bboxes  # å­˜å‚¨è¾¹ç•Œæ¡†
        self.format = format  # å­˜å‚¨è¾¹ç•Œæ¡†æ ¼å¼

    def convert(self, format):
        """
        å°†è¾¹ç•Œæ¡†æ ¼å¼ä»ä¸€ç§ç±»å‹è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹ã€‚
        
        å‚æ•°:
            format (str): ç›®æ ‡æ ¼å¼ï¼Œå¿…é¡»æ˜¯ 'xyxy', 'xywh', 'ltwh' ä¸­çš„ä¸€ç§ã€‚
        """
        assert format in _formats, f"æ— æ•ˆçš„è¾¹ç•Œæ¡†æ ¼å¼: {format}, æ ¼å¼å¿…é¡»æ˜¯ {_formats} ä¸­çš„ä¸€ç§"
        if self.format == format:
            return  # å¦‚æœæ ¼å¼ç›¸åŒï¼Œä¸åšä»»ä½•æ“ä½œ
        # æ ¹æ®å½“å‰æ ¼å¼å’Œç›®æ ‡æ ¼å¼é€‰æ‹©è½¬æ¢å‡½æ•°
        func = {
            "xyxy": xyxy2xywh if format == "xywh" else xyxy2ltwh,
            "xywh": xywh2xyxy if format == "xyxy" else xywh2ltwh,
            "ltwh": ltwh2xyxy if format == "xyxy" else ltwh2xywh
        }[self.format]
        self.bboxes = func(self.bboxes)  # è½¬æ¢è¾¹ç•Œæ¡†
        self.format = format  # æ›´æ–°æ ¼å¼

    def areas(self):
        """è¿”å›æ¯ä¸ªè¾¹ç•Œæ¡†çš„é¢ç§¯ã€‚"""
        self.convert("xyxy")  # ç¡®ä¿è¾¹ç•Œæ¡†æ ¼å¼ä¸º 'xyxy'
        # è®¡ç®—é¢ç§¯ï¼šå®½ * é«˜
        return (self.bboxes[:, 2] - self.bboxes[:, 0]) * (self.bboxes[:, 3] - self.bboxes[:, 1])

    def __len__(self):
        """è¿”å›è¾¹ç•Œæ¡†çš„æ•°é‡ã€‚"""
        return len(self.bboxes)

class Instances:
    """
    å­˜å‚¨å›¾åƒä¸­æ£€æµ‹åˆ°çš„å¯¹è±¡çš„è¾¹ç•Œæ¡†ã€åˆ†æ®µå’Œå…³é”®ç‚¹çš„å®¹å™¨ã€‚
    """

    def __init__(self, bboxes, segments=None, keypoints=None, bbox_format="xywh", normalized=True) -> None:
        """
        åˆå§‹åŒ– Instances ç±»ï¼Œæ¥æ”¶è¾¹ç•Œæ¡†ã€åˆ†æ®µå’Œå…³é”®ç‚¹æ•°æ®ã€‚
        
        å‚æ•°:
            bboxes (ndarray): è¾¹ç•Œæ¡†æ•°ç»„ï¼Œå½¢çŠ¶ä¸º [N, 4]ã€‚
            segments (list | ndarray, optional): å¯¹è±¡åˆ†æ®µï¼Œé»˜è®¤ä¸º Noneã€‚
            keypoints (ndarray, optional): å…³é”®ç‚¹æ•°ç»„ï¼Œå½¢çŠ¶ä¸º [N, 17, 3]ï¼Œé»˜è®¤ä¸º Noneã€‚
            bbox_format (str, optional): è¾¹ç•Œæ¡†æ ¼å¼ï¼Œé»˜è®¤ä¸º 'xywh'ã€‚
            normalized (bool, optional): è¾¹ç•Œæ¡†åæ ‡æ˜¯å¦ç»è¿‡å½’ä¸€åŒ–ï¼Œé»˜è®¤ä¸º Trueã€‚
        """
        self._bboxes = Bboxes(bboxes=bboxes, format=bbox_format)  # åˆ›å»º Bboxes å¯¹è±¡
        self.keypoints = keypoints  # å­˜å‚¨å…³é”®ç‚¹
        self.normalized = normalized  # å­˜å‚¨å½’ä¸€åŒ–æ ‡å¿—
        self.segments = segments  # å­˜å‚¨åˆ†æ®µ

    def convert_bbox(self, format):
        """è½¬æ¢è¾¹ç•Œæ¡†æ ¼å¼ã€‚"""
        self._bboxes.convert(format=format)

    @property
    def bbox_areas(self):
        """è®¡ç®—è¾¹ç•Œæ¡†çš„é¢ç§¯ã€‚"""
        return self._bboxes.areas()

    def __getitem__(self, index) -> "Instances":
        """
        ä½¿ç”¨ç´¢å¼•æ£€ç´¢ç‰¹å®šå®ä¾‹æˆ–ä¸€ç»„å®ä¾‹ã€‚
        
        å‚æ•°:
            index (int, slice, or np.ndarray): ç´¢å¼•ã€åˆ‡ç‰‡æˆ–å¸ƒå°”æ•°ç»„ï¼Œç”¨äºé€‰æ‹©æ‰€éœ€çš„å®ä¾‹ã€‚
        
        è¿”å›:
            Instances: åŒ…å«æ‰€é€‰è¾¹ç•Œæ¡†ã€åˆ†æ®µå’Œå…³é”®ç‚¹çš„æ–° Instances å¯¹è±¡ã€‚
        """
        segments = self.segments[index] if len(self.segments) else self.segments
        keypoints = self.keypoints[index] if self.keypoints is not None else None
        bboxes = self._bboxes[index]
        bbox_format = self._bboxes.format
        return Instances(
            bboxes=bboxes,
            segments=segments,
            keypoints=keypoints,
            bbox_format=bbox_format,
            normalized=self.normalized,
        )
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **Bboxes ç±»**ï¼šç”¨äºå¤„ç†è¾¹ç•Œæ¡†çš„ç±»ï¼Œæ”¯æŒå¤šç§æ ¼å¼ï¼ˆ`xyxy`, `xywh`, `ltwh`ï¼‰ï¼Œå¹¶æä¾›äº†æ ¼å¼è½¬æ¢ã€é¢ç§¯è®¡ç®—ç­‰åŠŸèƒ½ã€‚
2. **Instances ç±»**ï¼šç”¨äºå­˜å‚¨å›¾åƒä¸­æ£€æµ‹åˆ°çš„å¯¹è±¡çš„è¾¹ç•Œæ¡†ã€åˆ†æ®µå’Œå…³é”®ç‚¹ï¼Œæä¾›äº†æ ¼å¼è½¬æ¢å’Œç´¢å¼•åŠŸèƒ½ã€‚

### ä¸»è¦åŠŸèƒ½ï¼š
- **æ ¼å¼è½¬æ¢**ï¼šå¯ä»¥åœ¨ä¸åŒçš„è¾¹ç•Œæ¡†æ ¼å¼ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚
- **é¢ç§¯è®¡ç®—**ï¼šå¯ä»¥è®¡ç®—æ¯ä¸ªè¾¹ç•Œæ¡†çš„é¢ç§¯ã€‚
- **å®ä¾‹ç®¡ç†**ï¼šå¯ä»¥é€šè¿‡ç´¢å¼•è·å–ç‰¹å®šçš„è¾¹ç•Œæ¡†å®ä¾‹ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶å®šä¹‰äº†ä¸¤ä¸ªä¸»è¦çš„ç±»ï¼š`Bboxes`å’Œ`Instances`ï¼Œç”¨äºå¤„ç†è®¡ç®—æœºè§†è§‰ä¸­çš„è¾¹ç•Œæ¡†ï¼ˆbounding boxesï¼‰åŠå…¶ç›¸å…³ä¿¡æ¯ã€‚æ–‡ä»¶å¼€å¤´å¼•å…¥äº†ä¸€äº›å¿…è¦çš„åº“å’Œå‡½æ•°ï¼ŒåŒ…æ‹¬ç”¨äºè¾¹ç•Œæ¡†æ ¼å¼è½¬æ¢çš„å‡½æ•°å’Œç±»å‹æ³¨è§£ã€‚

`Bboxes`ç±»ç”¨äºç®¡ç†è¾¹ç•Œæ¡†ï¼Œæ”¯æŒå¤šç§æ ¼å¼ï¼ˆå¦‚`xyxy`ã€`xywh`å’Œ`ltwh`ï¼‰ã€‚åœ¨åˆå§‹åŒ–æ—¶ï¼Œç”¨æˆ·éœ€è¦æä¾›è¾¹ç•Œæ¡†æ•°æ®å’Œæ ¼å¼ï¼Œç¨‹åºä¼šè¿›è¡Œæ ¼å¼éªŒè¯ï¼Œå¹¶ç¡®ä¿è¾“å…¥æ•°æ®æ˜¯äºŒç»´çš„ã€‚è¯¥ç±»æä¾›äº†å¤šç§æ–¹æ³•æ¥è½¬æ¢è¾¹ç•Œæ¡†æ ¼å¼ã€è®¡ç®—é¢ç§¯ã€ç¼©æ”¾ã€æ·»åŠ åç§»ç­‰æ“ä½œã€‚`convert`æ–¹æ³•å¯ä»¥å°†è¾¹ç•Œæ¡†ä»ä¸€ç§æ ¼å¼è½¬æ¢ä¸ºå¦ä¸€ç§æ ¼å¼ï¼Œ`areas`æ–¹æ³•è®¡ç®—æ¯ä¸ªè¾¹ç•Œæ¡†çš„é¢ç§¯ã€‚ç±»ä¸­è¿˜å®šä¹‰äº†`mul`å’Œ`add`æ–¹æ³•ï¼Œåˆ†åˆ«ç”¨äºæŒ‰æ¯”ä¾‹ç¼©æ”¾å’Œæ·»åŠ åç§»é‡ã€‚

`Instances`ç±»åˆ™æ˜¯ä¸€ä¸ªæ›´é«˜å±‚æ¬¡çš„å®¹å™¨ï¼Œé™¤äº†åŒ…å«è¾¹ç•Œæ¡†å¤–ï¼Œè¿˜å¯ä»¥å­˜å‚¨åˆ†å‰²ä¿¡æ¯å’Œå…³é”®ç‚¹ã€‚åˆå§‹åŒ–æ—¶ï¼Œç”¨æˆ·å¯ä»¥æä¾›è¾¹ç•Œæ¡†ã€åˆ†å‰²å’Œå…³é”®ç‚¹æ•°æ®ã€‚è¯¥ç±»æä¾›äº†ç±»ä¼¼äº`Bboxes`çš„åŠŸèƒ½ï¼Œä½†ä¹Ÿå¢åŠ äº†å¤„ç†åˆ†å‰²å’Œå…³é”®ç‚¹çš„èƒ½åŠ›ã€‚å®ƒåŒ…å«æ–¹æ³•ç”¨äºæ ¼å¼è½¬æ¢ã€ç¼©æ”¾ã€å½’ä¸€åŒ–å’Œå»é™¤é›¶é¢ç§¯çš„è¾¹ç•Œæ¡†ç­‰ã€‚`scale`ã€`denormalize`å’Œ`normalize`æ–¹æ³•åˆ†åˆ«ç”¨äºç¼©æ”¾ã€å»å½’ä¸€åŒ–å’Œå½’ä¸€åŒ–è¾¹ç•Œæ¡†åŠå…¶ç›¸å…³ä¿¡æ¯ã€‚

ä¸¤ä¸ªç±»éƒ½å®ç°äº†ç´¢å¼•åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡ç´¢å¼•è·å–ç‰¹å®šçš„è¾¹ç•Œæ¡†æˆ–å®ä¾‹ã€‚`Bboxes`ç±»æ”¯æŒå°†å¤šä¸ª`Bboxes`å¯¹è±¡è¿æ¥æˆä¸€ä¸ªï¼Œè€Œ`Instances`ç±»åˆ™æ”¯æŒå°†å¤šä¸ª`Instances`å¯¹è±¡è¿æ¥æˆä¸€ä¸ªï¼Œä¾¿äºæ‰¹é‡å¤„ç†ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†ä¸€å¥—å®Œæ•´çš„å·¥å…·ï¼Œç”¨äºå¤„ç†å’Œæ“ä½œè®¡ç®—æœºè§†è§‰ä¸­çš„è¾¹ç•Œæ¡†åŠå…¶ç›¸å…³æ•°æ®ï¼Œæ–¹ä¾¿åç»­çš„å›¾åƒå¤„ç†å’Œåˆ†æã€‚

#### 11.3 ui.py

ä»¥ä¸‹æ˜¯ä¿ç•™çš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼Œå¹¶æ·»åŠ äº†è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import sys
import subprocess

def run_script(script_path):
    """
    ä½¿ç”¨å½“å‰ Python ç¯å¢ƒè¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

    Args:
        script_path (str): è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„

    Returns:
        None
    """
    # è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„
    python_path = sys.executable

    # æ„å»ºè¿è¡Œå‘½ä»¤ï¼Œä½¿ç”¨ streamlit è¿è¡ŒæŒ‡å®šçš„è„šæœ¬
    command = f'"{python_path}" -m streamlit run "{script_path}"'

    # æ‰§è¡Œå‘½ä»¤
    result = subprocess.run(command, shell=True)
    
    # æ£€æŸ¥å‘½ä»¤æ‰§è¡Œç»“æœï¼Œå¦‚æœè¿”å›ç ä¸ä¸º0ï¼Œåˆ™è¡¨ç¤ºè¿è¡Œå‡ºé”™
    if result.returncode != 0:
        print("è„šæœ¬è¿è¡Œå‡ºé”™ã€‚")

# å®ä¾‹åŒ–å¹¶è¿è¡Œåº”ç”¨
if __name__ == "__main__":
    # æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„
    script_path = "web.py"  # å‡è®¾è„šæœ¬åœ¨å½“å‰ç›®å½•ä¸‹

    # è°ƒç”¨å‡½æ•°è¿è¡Œè„šæœ¬
    run_script(script_path)
```

### ä»£ç æ³¨é‡Šè¯´æ˜ï¼š
1. **å¯¼å…¥æ¨¡å—**ï¼š
   - `sys`ï¼šç”¨äºè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚
   - `subprocess`ï¼šç”¨äºæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚

2. **`run_script` å‡½æ•°**ï¼š
   - å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè¿è¡ŒæŒ‡å®šè·¯å¾„çš„ Python è„šæœ¬ã€‚
   - ä½¿ç”¨ `sys.executable` è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œä»¥ç¡®ä¿è„šæœ¬åœ¨æ­£ç¡®çš„ç¯å¢ƒä¸­è¿è¡Œã€‚
   - æ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ `streamlit` æ¨¡å—è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚
   - ä½¿ç”¨ `subprocess.run` æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶é€šè¿‡ `shell=True` å…è®¸åœ¨ shell ä¸­æ‰§è¡Œã€‚
   - æ£€æŸ¥å‘½ä»¤çš„è¿”å›ç ï¼Œå¦‚æœä¸ä¸º0ï¼Œè¡¨ç¤ºæ‰§è¡Œå‡ºé”™ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯ã€‚

3. **ä¸»ç¨‹åºéƒ¨åˆ†**ï¼š
   - ä½¿ç”¨ `if __name__ == "__main__":` ç¡®ä¿åªæœ‰åœ¨ç›´æ¥è¿è¡Œè¯¥è„šæœ¬æ—¶æ‰ä¼šæ‰§è¡Œä»¥ä¸‹ä»£ç ã€‚
   - æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ï¼ˆè¿™é‡Œå‡è®¾è„šæœ¬åœ¨å½“å‰ç›®å½•ä¸‹ï¼‰ã€‚
   - è°ƒç”¨ `run_script` å‡½æ•°ï¼Œä¼ å…¥è„šæœ¬è·¯å¾„ä»¥æ‰§è¡Œè¯¥è„šæœ¬ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶åä¸º `ui.py`ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯é€šè¿‡å½“å‰çš„ Python ç¯å¢ƒæ¥è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„è„šæœ¬ï¼Œå…·ä½“æ˜¯ä½¿ç”¨ Streamlit æ¡†æ¶æ¥å¯åŠ¨ä¸€ä¸ª Web åº”ç”¨ã€‚

é¦–å…ˆï¼Œç¨‹åºå¯¼å…¥äº†å‡ ä¸ªå¿…è¦çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ `sys`ã€`os` å’Œ `subprocess`ã€‚`sys` æ¨¡å—ç”¨äºè®¿é—®ä¸ Python è§£é‡Šå™¨ç´§å¯†ç›¸å…³çš„å˜é‡å’Œå‡½æ•°ï¼Œ`os` æ¨¡å—æä¾›äº†ä¸æ“ä½œç³»ç»Ÿäº¤äº’çš„åŠŸèƒ½ï¼Œè€Œ `subprocess` æ¨¡å—åˆ™ç”¨äºåˆ›å»ºæ–°è¿›ç¨‹ã€è¿æ¥åˆ°å®ƒä»¬çš„è¾“å…¥/è¾“å‡º/é”™è¯¯ç®¡é“ï¼Œå¹¶è·å–å®ƒä»¬çš„è¿”å›ç ã€‚

æ¥ä¸‹æ¥ï¼Œç¨‹åºä» `QtFusion.path` æ¨¡å—ä¸­å¯¼å…¥äº† `abs_path` å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯è·å–æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚

åœ¨ `run_script` å‡½æ•°ä¸­ï¼Œç¨‹åºæ¥æ”¶ä¸€ä¸ªå‚æ•° `script_path`ï¼Œè¡¨ç¤ºè¦è¿è¡Œçš„è„šæœ¬çš„è·¯å¾„ã€‚å‡½æ•°é¦–å…ˆè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨ `python_path` å˜é‡ä¸­ã€‚ç„¶åï¼Œæ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ Streamlit æ¥è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚è¿™ä¸ªå‘½ä»¤ä½¿ç”¨äº† `-m` é€‰é¡¹æ¥æŒ‡å®šæ¨¡å—è¿è¡Œã€‚

æ¥ç€ï¼Œç¨‹åºé€šè¿‡ `subprocess.run` æ–¹æ³•æ‰§è¡Œæ„å»ºå¥½çš„å‘½ä»¤ã€‚å¦‚æœå‘½ä»¤æ‰§è¡Œçš„è¿”å›ç ä¸ä¸ºé›¶ï¼Œè¯´æ˜è„šæœ¬è¿è¡Œè¿‡ç¨‹ä¸­å‡ºç°äº†é”™è¯¯ï¼Œç¨‹åºä¼šè¾“å‡ºâ€œè„šæœ¬è¿è¡Œå‡ºé”™ã€‚â€çš„æç¤ºä¿¡æ¯ã€‚

åœ¨æ–‡ä»¶çš„æœ€åéƒ¨åˆ†ï¼Œç¨‹åºé€šè¿‡ `if __name__ == "__main__":` è¯­å¥æ¥åˆ¤æ–­æ˜¯å¦æ˜¯ç›´æ¥è¿è¡Œè¯¥è„šæœ¬ã€‚å¦‚æœæ˜¯ï¼Œç¨‹åºä¼šæŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ï¼Œè¿™é‡Œæ˜¯ `web.py`ï¼Œå¹¶è°ƒç”¨ `run_script` å‡½æ•°æ¥æ‰§è¡Œè¿™ä¸ªè„šæœ¬ã€‚

æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸ªç¨‹åºçš„ä¸»è¦åŠŸèƒ½æ˜¯ä¸ºç”¨æˆ·æä¾›ä¸€ä¸ªç®€å•çš„æ¥å£ï¼Œä»¥ä¾¿é€šè¿‡å½“å‰çš„ Python ç¯å¢ƒæ¥è¿è¡Œä¸€ä¸ª Streamlit Web åº”ç”¨è„šæœ¬ã€‚

#### 11.4 code\ultralytics\models\fastsam\prompt.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import os
import numpy as np
import torch
from PIL import Image
import cv2
from ultralytics.utils import TQDM

class FastSAMPrompt:
    """
    Fast Segment Anything Modelç±»ï¼Œç”¨äºå›¾åƒæ ‡æ³¨å’Œå¯è§†åŒ–ã€‚

    å±æ€§:
        device (str): è®¡ç®—è®¾å¤‡ï¼ˆ'cuda'æˆ–'cpu'ï¼‰ã€‚
        results: ç›®æ ‡æ£€æµ‹æˆ–åˆ†å‰²ç»“æœã€‚
        source: æºå›¾åƒæˆ–å›¾åƒè·¯å¾„ã€‚
        clip: ç”¨äºçº¿æ€§åˆ†é…çš„CLIPæ¨¡å‹ã€‚
    """

    def __init__(self, source, results, device="cuda") -> None:
        """åˆå§‹åŒ–FastSAMPromptï¼Œè®¾ç½®æºå›¾åƒã€ç»“æœå’Œè®¾å¤‡ï¼Œå¹¶å¯¼å…¥CLIPæ¨¡å‹ã€‚"""
        self.device = device
        self.results = results
        self.source = source

        # å¯¼å…¥å¹¶åˆ†é…CLIPæ¨¡å‹
        try:
            import clip  # ç”¨äºçº¿æ€§åˆ†é…
        except ImportError:
            from ultralytics.utils.checks import check_requirements
            check_requirements("git+https://github.com/openai/CLIP.git")
            import clip
        self.clip = clip

    @staticmethod
    def _format_results(result, filter=0):
        """å°†æ£€æµ‹ç»“æœæ ¼å¼åŒ–ä¸ºåŒ…å«IDã€åˆ†å‰²ã€è¾¹ç•Œæ¡†ã€å¾—åˆ†å’Œé¢ç§¯çš„æ³¨é‡Šåˆ—è¡¨ã€‚"""
        annotations = []
        n = len(result.masks.data) if result.masks is not None else 0
        for i in range(n):
            mask = result.masks.data[i] == 1.0
            if torch.sum(mask) >= filter:
                annotation = {
                    "id": i,
                    "segmentation": mask.cpu().numpy(),
                    "bbox": result.boxes.data[i],
                    "score": result.boxes.conf[i],
                }
                annotation["area"] = annotation["segmentation"].sum()
                annotations.append(annotation)
        return annotations

    @torch.no_grad()
    def retrieve(self, model, preprocess, elements, search_text: str, device) -> int:
        """å¤„ç†å›¾åƒå’Œæ–‡æœ¬ï¼Œè®¡ç®—ç›¸ä¼¼åº¦ï¼Œå¹¶è¿”å›softmaxå¾—åˆ†ã€‚"""
        preprocessed_images = [preprocess(image).to(device) for image in elements]
        tokenized_text = self.clip.tokenize([search_text]).to(device)
        stacked_images = torch.stack(preprocessed_images)
        image_features = model.encode_image(stacked_images)
        text_features = model.encode_text(tokenized_text)
        image_features /= image_features.norm(dim=-1, keepdim=True)
        text_features /= text_features.norm(dim=-1, keepdim=True)
        probs = 100.0 * image_features @ text_features.T
        return probs[:, 0].softmax(dim=0)

    def text_prompt(self, text):
        """å¤„ç†æ–‡æœ¬æç¤ºï¼Œåº”ç”¨äºç°æœ‰ç»“æœå¹¶è¿”å›æ›´æ–°åçš„ç»“æœã€‚"""
        if self.results[0].masks is not None:
            format_results = self._format_results(self.results[0], 0)
            cropped_boxes, cropped_images, not_crop, filter_id, annotations = self._crop_image(format_results)
            clip_model, preprocess = self.clip.load("ViT-B/32", device=self.device)
            scores = self.retrieve(clip_model, preprocess, cropped_boxes, text, device=self.device)
            max_idx = scores.argsort()[-1]  # è·å–å¾—åˆ†æœ€é«˜çš„ç´¢å¼•
            max_idx += sum(np.array(filter_id) <= int(max_idx))  # å¤„ç†è¿‡æ»¤çš„ç´¢å¼•
            self.results[0].masks.data = torch.tensor(np.array([annotations[max_idx]["segmentation"]]))
        return self.results

    def everything_prompt(self):
        """è¿”å›ç±»ä¸­å…ˆå‰æ–¹æ³•å¤„ç†åçš„ç»“æœã€‚"""
        return self.results
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **ç±»çš„å®šä¹‰**ï¼š`FastSAMPrompt`ç±»ç”¨äºå¤„ç†å›¾åƒåˆ†å‰²å’Œæ ‡æ³¨ä»»åŠ¡ï¼ŒåŒ…å«äº†è®¾å¤‡é€‰æ‹©ã€ç»“æœå­˜å‚¨å’ŒCLIPæ¨¡å‹çš„åŠ è½½ã€‚
2. **åˆå§‹åŒ–æ–¹æ³•**ï¼š`__init__`æ–¹æ³•è´Ÿè´£åˆå§‹åŒ–ç±»çš„å±æ€§ï¼Œå¹¶å¯¼å…¥CLIPæ¨¡å‹ã€‚
3. **ç»“æœæ ¼å¼åŒ–**ï¼š`_format_results`æ–¹æ³•å°†æ£€æµ‹ç»“æœæ ¼å¼åŒ–ä¸ºåŒ…å«å¿…è¦ä¿¡æ¯çš„æ³¨é‡Šåˆ—è¡¨ï¼Œä¾¿äºåç»­å¤„ç†ã€‚
4. **ç›¸ä¼¼åº¦è®¡ç®—**ï¼š`retrieve`æ–¹æ³•é€šè¿‡CLIPæ¨¡å‹è®¡ç®—å›¾åƒå’Œæ–‡æœ¬ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œå¹¶è¿”å›softmaxå¾—åˆ†ï¼Œå¸®åŠ©é€‰æ‹©æœ€ç›¸å…³çš„åˆ†å‰²ç»“æœã€‚
5. **æ–‡æœ¬æç¤ºå¤„ç†**ï¼š`text_prompt`æ–¹æ³•æ¥æ”¶æ–‡æœ¬è¾“å…¥ï¼Œåˆ©ç”¨CLIPæ¨¡å‹å’Œä¹‹å‰æ ¼å¼åŒ–çš„ç»“æœæ›´æ–°åˆ†å‰²ç»“æœã€‚
6. **è·å–æ‰€æœ‰ç»“æœ**ï¼š`everything_prompt`æ–¹æ³•è¿”å›å½“å‰å¤„ç†çš„ç»“æœï¼Œä¾¿äºå¤–éƒ¨è°ƒç”¨ã€‚

è¿™äº›æ ¸å¿ƒéƒ¨åˆ†æ„æˆäº†å›¾åƒåˆ†å‰²å’Œæ ‡æ³¨çš„åŸºæœ¬æ¡†æ¶ï¼Œèƒ½å¤Ÿå¤„ç†è¾“å…¥å›¾åƒå¹¶æ ¹æ®ç”¨æˆ·çš„æ–‡æœ¬æç¤ºç”Ÿæˆç›¸åº”çš„åˆ†å‰²ç»“æœã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º `FastSAMPrompt` çš„ç±»ï¼Œä¸»è¦ç”¨äºå›¾åƒæ³¨é‡Šå’Œå¯è§†åŒ–ï¼Œç‰¹åˆ«æ˜¯åœ¨å›¾åƒåˆ†å‰²å’Œç›®æ ‡æ£€æµ‹æ–¹é¢ã€‚è¯¥ç±»çš„æ„é€ å‡½æ•°æ¥å—æºå›¾åƒã€æ£€æµ‹ç»“æœå’Œè®¡ç®—è®¾å¤‡ï¼ˆå¦‚ CUDA æˆ– CPUï¼‰ä½œä¸ºå‚æ•°ï¼Œå¹¶å°è¯•å¯¼å…¥ CLIP æ¨¡å‹ç”¨äºçº¿æ€§åˆ†é…ã€‚

åœ¨ç±»ä¸­ï¼Œæœ‰å¤šä¸ªé™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ã€‚é™æ€æ–¹æ³•åŒ…æ‹¬ `_segment_image`ã€`_format_results`ã€`_get_bbox_from_mask` ç­‰ï¼Œç”¨äºå¤„ç†å›¾åƒåˆ†å‰²ã€æ ¼å¼åŒ–æ£€æµ‹ç»“æœå’Œä»æ©ç ä¸­è·å–è¾¹ç•Œæ¡†ã€‚è¿™äº›æ–¹æ³•å¸®åŠ©å°†è¾“å…¥å›¾åƒæ ¹æ®ç»™å®šçš„è¾¹ç•Œæ¡†è¿›è¡Œåˆ†å‰²ï¼Œå¹¶å°†æ£€æµ‹ç»“æœæ•´ç†æˆåŒ…å« IDã€åˆ†å‰²æ©ç ã€è¾¹ç•Œæ¡†å’Œç½®ä¿¡åº¦åˆ†æ•°çš„æ³¨é‡Šåˆ—è¡¨ã€‚

`plot` æ–¹æ³•ç”¨äºåœ¨å›¾åƒä¸Šç»˜åˆ¶æ³¨é‡Šã€è¾¹ç•Œæ¡†å’Œç‚¹ï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°æŒ‡å®šçš„è¾“å‡ºç›®å½•ã€‚è¯¥æ–¹æ³•ä½¿ç”¨ `matplotlib` è¿›è¡Œå¯è§†åŒ–ï¼Œå¹¶æ”¯æŒå¤šç§é€‰é¡¹ï¼Œå¦‚æ˜¯å¦ä½¿ç”¨éšæœºé¢œè‰²ã€æ˜¯å¦ç»˜åˆ¶è½®å»“ç­‰ã€‚

`fast_show_mask` æ–¹æ³•åˆ™ç”¨äºå¿«é€Ÿæ˜¾ç¤ºæ©ç æ³¨é‡Šï¼Œæ”¯æŒéšæœºé¢œè‰²å’Œé€æ˜åº¦è®¾ç½®ã€‚è¯¥æ–¹æ³•é€šè¿‡å¤„ç†æ©ç æ•°æ®ï¼Œå°†å…¶å¯è§†åŒ–åˆ°æŒ‡å®šçš„ `matplotlib` è½´ä¸Šã€‚

ç±»ä¸­è¿˜åŒ…å«ä¸€äº›ä¸æ–‡æœ¬å’Œç‚¹æç¤ºç›¸å…³çš„æ–¹æ³•ï¼Œå¦‚ `retrieve`ã€`box_prompt`ã€`point_prompt` å’Œ `text_prompt`ã€‚è¿™äº›æ–¹æ³•å…è®¸ç”¨æˆ·é€šè¿‡æ–‡æœ¬ã€ç‚¹æˆ–è¾¹ç•Œæ¡†ä¸æ¨¡å‹äº¤äº’ï¼Œä¿®æ”¹åˆ†å‰²ç»“æœã€‚ä¾‹å¦‚ï¼Œ`box_prompt` æ–¹æ³•é€šè¿‡è®¡ç®—æ©ç ä¸è¾¹ç•Œæ¡†ä¹‹é—´çš„äº¤å¹¶æ¯”ï¼ˆIoUï¼‰æ¥è°ƒæ•´æ©ç ï¼Œè€Œ `point_prompt` æ–¹æ³•åˆ™æ ¹æ®ç”¨æˆ·è¾“å…¥çš„ç‚¹æ¥ä¿®æ”¹æ©ç ã€‚

æœ€åï¼Œ`everything_prompt` æ–¹æ³•è¿”å›ç±»ä¸­å¤„ç†åçš„ç»“æœï¼Œæ–¹ä¾¿ç”¨æˆ·è·å–æœ€ç»ˆçš„åˆ†å‰²ç»“æœã€‚

æ•´ä½“æ¥çœ‹ï¼Œè¿™ä¸ªç±»æä¾›äº†ä¸€æ•´å¥—å›¾åƒåˆ†å‰²å’Œæ³¨é‡Šçš„å·¥å…·ï¼Œç»“åˆäº†æ·±åº¦å­¦ä¹ æ¨¡å‹å’Œç”¨æˆ·äº¤äº’ï¼Œé€‚ç”¨äºéœ€è¦é«˜æ•ˆå›¾åƒå¤„ç†å’Œå¯è§†åŒ–çš„åœºæ™¯ã€‚

#### 11.5 train.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
class DetectionTrainer(BaseTrainer):
    """
    DetectionTrainerç±»ç”¨äºåŸºäºæ£€æµ‹æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œç»§æ‰¿è‡ªBaseTrainerç±»ã€‚
    """

    def build_dataset(self, img_path, mode="train", batch=None):
        """
        æ„å»ºYOLOæ•°æ®é›†ã€‚

        å‚æ•°:
            img_path (str): åŒ…å«å›¾åƒçš„æ–‡ä»¶å¤¹è·¯å¾„ã€‚
            mode (str): æ¨¡å¼ï¼Œå¯ä»¥æ˜¯'train'æˆ–'val'ï¼Œç”¨æˆ·å¯ä»¥ä¸ºæ¯ç§æ¨¡å¼è‡ªå®šä¹‰ä¸åŒçš„å¢å¼ºã€‚
            batch (int, optional): æ‰¹æ¬¡å¤§å°ï¼Œä»…åœ¨'rect'æ¨¡å¼ä¸‹ä½¿ç”¨ã€‚é»˜è®¤ä¸ºNoneã€‚
        """
        gs = max(int(de_parallel(self.model).stride.max() if self.model else 0), 32)
        return build_yolo_dataset(self.args, img_path, batch, self.data, mode=mode, rect=mode == "val", stride=gs)

    def get_dataloader(self, dataset_path, batch_size=16, rank=0, mode="train"):
        """æ„é€ å¹¶è¿”å›æ•°æ®åŠ è½½å™¨ã€‚"""
        assert mode in ["train", "val"]  # ç¡®ä¿æ¨¡å¼æœ‰æ•ˆ
        with torch_distributed_zero_first(rank):  # ä»…åœ¨DDPæƒ…å†µä¸‹åˆå§‹åŒ–æ•°æ®é›†*.cacheä¸€æ¬¡
            dataset = self.build_dataset(dataset_path, mode, batch_size)
        shuffle = mode == "train"  # è®­ç»ƒæ¨¡å¼ä¸‹æ‰“ä¹±æ•°æ®
        if getattr(dataset, "rect", False) and shuffle:
            LOGGER.warning("WARNING âš ï¸ 'rect=True'ä¸DataLoaderçš„shuffleä¸å…¼å®¹ï¼Œè®¾ç½®shuffle=False")
            shuffle = False
        workers = self.args.workers if mode == "train" else self.args.workers * 2  # è®¾ç½®å·¥ä½œçº¿ç¨‹æ•°
        return build_dataloader(dataset, batch_size, workers, shuffle, rank)  # è¿”å›æ•°æ®åŠ è½½å™¨

    def preprocess_batch(self, batch):
        """å¯¹ä¸€æ‰¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬ç¼©æ”¾å’Œè½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚"""
        batch["img"] = batch["img"].to(self.device, non_blocking=True).float() / 255  # å°†å›¾åƒè½¬æ¢ä¸ºæµ®ç‚¹æ•°å¹¶å½’ä¸€åŒ–
        if self.args.multi_scale:  # å¦‚æœå¯ç”¨å¤šå°ºåº¦
            imgs = batch["img"]
            sz = (
                random.randrange(self.args.imgsz * 0.5, self.args.imgsz * 1.5 + self.stride)
                // self.stride
                * self.stride
            )  # éšæœºé€‰æ‹©å›¾åƒå¤§å°
            sf = sz / max(imgs.shape[2:])  # è®¡ç®—ç¼©æ”¾å› å­
            if sf != 1:
                ns = [
                    math.ceil(x * sf / self.stride) * self.stride for x in imgs.shape[2:]
                ]  # è®¡ç®—æ–°çš„å½¢çŠ¶
                imgs = nn.functional.interpolate(imgs, size=ns, mode="bilinear", align_corners=False)  # è¿›è¡Œæ’å€¼
            batch["img"] = imgs  # æ›´æ–°å›¾åƒ
        return batch

    def set_model_attributes(self):
        """è®¾ç½®æ¨¡å‹çš„å±æ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œåç§°ã€‚"""
        self.model.nc = self.data["nc"]  # å°†ç±»åˆ«æ•°é‡é™„åŠ åˆ°æ¨¡å‹
        self.model.names = self.data["names"]  # å°†ç±»åˆ«åç§°é™„åŠ åˆ°æ¨¡å‹
        self.model.args = self.args  # å°†è¶…å‚æ•°é™„åŠ åˆ°æ¨¡å‹

    def get_model(self, cfg=None, weights=None, verbose=True):
        """è¿”å›YOLOæ£€æµ‹æ¨¡å‹ã€‚"""
        model = DetectionModel(cfg, nc=self.data["nc"], verbose=verbose and RANK == -1)  # åˆ›å»ºæ£€æµ‹æ¨¡å‹
        if weights:
            model.load(weights)  # åŠ è½½æƒé‡
        return model

    def get_validator(self):
        """è¿”å›YOLOæ¨¡å‹éªŒè¯å™¨ã€‚"""
        self.loss_names = "box_loss", "cls_loss", "dfl_loss"  # å®šä¹‰æŸå¤±åç§°
        return yolo.detect.DetectionValidator(
            self.test_loader, save_dir=self.save_dir, args=copy(self.args), _callbacks=self.callbacks
        )

    def plot_training_samples(self, batch, ni):
        """ç»˜åˆ¶å¸¦æœ‰æ³¨é‡Šçš„è®­ç»ƒæ ·æœ¬ã€‚"""
        plot_images(
            images=batch["img"],
            batch_idx=batch["batch_idx"],
            cls=batch["cls"].squeeze(-1),
            bboxes=batch["bboxes"],
            paths=batch["im_file"],
            fname=self.save_dir / f"train_batch{ni}.jpg",
            on_plot=self.on_plot,
        )

    def plot_metrics(self):
        """ä»CSVæ–‡ä»¶ä¸­ç»˜åˆ¶æŒ‡æ ‡ã€‚"""
        plot_results(file=self.csv, on_plot=self.on_plot)  # ä¿å­˜ç»“æœå›¾

    def plot_training_labels(self):
        """åˆ›å»ºYOLOæ¨¡å‹çš„æ ‡è®°è®­ç»ƒå›¾ã€‚"""
        boxes = np.concatenate([lb["bboxes"] for lb in self.train_loader.dataset.labels], 0)  # åˆå¹¶æ‰€æœ‰è¾¹ç•Œæ¡†
        cls = np.concatenate([lb["cls"] for lb in self.train_loader.dataset.labels], 0)  # åˆå¹¶æ‰€æœ‰ç±»åˆ«
        plot_labels(boxes, cls.squeeze(), names=self.data["names"], save_dir=self.save_dir, on_plot=self.on_plot)  # ç»˜åˆ¶æ ‡ç­¾
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **DetectionTrainerç±»**ï¼šç”¨äºç®¡ç†YOLOæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼ŒåŒ…å«æ•°æ®é›†æ„å»ºã€æ•°æ®åŠ è½½ã€æ¨¡å‹è®¾ç½®ç­‰åŠŸèƒ½ã€‚
2. **build_dataset**ï¼šæ ¹æ®è¾“å…¥è·¯å¾„å’Œæ¨¡å¼æ„å»ºYOLOæ•°æ®é›†ã€‚
3. **get_dataloader**ï¼šæ„å»ºå¹¶è¿”å›æ•°æ®åŠ è½½å™¨ï¼Œæ”¯æŒåˆ†å¸ƒå¼è®­ç»ƒã€‚
4. **preprocess_batch**ï¼šå¯¹è¾“å…¥çš„å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å½’ä¸€åŒ–å’Œå¤šå°ºåº¦è°ƒæ•´ã€‚
5. **set_model_attributes**ï¼šè®¾ç½®æ¨¡å‹çš„ç±»åˆ«æ•°é‡å’Œåç§°ç­‰å±æ€§ã€‚
6. **get_model**ï¼šè¿”å›YOLOæ£€æµ‹æ¨¡å‹ï¼Œå¹¶å¯é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚
7. **get_validator**ï¼šè¿”å›ç”¨äºéªŒè¯æ¨¡å‹çš„éªŒè¯å™¨ã€‚
8. **plot_training_samples**ã€**plot_metrics**ã€**plot_training_labels**ï¼šç”¨äºå¯è§†åŒ–è®­ç»ƒæ ·æœ¬ã€è®­ç»ƒæŒ‡æ ‡å’Œæ ‡ç­¾ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `train.py` æ˜¯ä¸€ä¸ªç”¨äºè®­ç»ƒ YOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„å®ç°ï¼Œç»§æ‰¿è‡ª `BaseTrainer` ç±»ã€‚å®ƒä¸»è¦åŒ…å«äº†æ„å»ºæ•°æ®é›†ã€æ•°æ®åŠ è½½ã€é¢„å¤„ç†ã€æ¨¡å‹è®¾ç½®ã€è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±è®¡ç®—å’Œå¯è§†åŒ–ç­‰åŠŸèƒ½ã€‚

é¦–å…ˆï¼Œæ–‡ä»¶å¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“å’Œæ¨¡å—ï¼ŒåŒ…æ‹¬æ•°å­¦è¿ç®—ã€éšæœºæ•°ç”Ÿæˆã€æ·±åº¦å­¦ä¹ æ¡†æ¶ PyTorch ç›¸å…³çš„æ¨¡å—ï¼Œä»¥åŠ Ultralytics æä¾›çš„ YOLO ç›¸å…³å·¥å…·å’Œå‡½æ•°ã€‚æ¥ç€ï¼Œå®šä¹‰äº† `DetectionTrainer` ç±»ï¼Œè¯¥ç±»è´Ÿè´£è®­ç»ƒåŸºäº YOLO çš„ç›®æ ‡æ£€æµ‹æ¨¡å‹ã€‚

åœ¨ `DetectionTrainer` ç±»ä¸­ï¼Œ`build_dataset` æ–¹æ³•ç”¨äºæ„å»º YOLO æ•°æ®é›†ã€‚å®ƒæ¥æ”¶å›¾åƒè·¯å¾„ã€æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰å’Œæ‰¹é‡å¤§å°ä½œä¸ºå‚æ•°ï¼Œå¹¶æ ¹æ®æ¨¡å‹çš„æ­¥å¹…è®¡ç®—åˆé€‚çš„å‚æ•°æ¥æ„å»ºæ•°æ®é›†ã€‚

`get_dataloader` æ–¹æ³•ç”¨äºåˆ›å»ºæ•°æ®åŠ è½½å™¨ï¼Œç¡®ä¿åœ¨åˆ†å¸ƒå¼è®­ç»ƒæ—¶åªåˆå§‹åŒ–ä¸€æ¬¡æ•°æ®é›†ã€‚å®ƒä¼šæ ¹æ®æ¨¡å¼å†³å®šæ˜¯å¦æ‰“ä¹±æ•°æ®ï¼Œå¹¶æ ¹æ®è®­ç»ƒæˆ–éªŒè¯çš„éœ€è¦è®¾ç½®å·¥ä½œçº¿ç¨‹æ•°ã€‚

`preprocess_batch` æ–¹æ³•è´Ÿè´£å¯¹è¾“å…¥çš„å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å°†å›¾åƒç¼©æ”¾åˆ°åˆé€‚çš„å¤§å°å¹¶è½¬æ¢ä¸ºæµ®ç‚¹æ•°æ ¼å¼ã€‚è¯¥æ–¹æ³•è¿˜æ”¯æŒå¤šå°ºåº¦è®­ç»ƒï¼Œé€šè¿‡éšæœºé€‰æ‹©å›¾åƒçš„å¤§å°æ¥å¢å¼ºæ¨¡å‹çš„é²æ£’æ€§ã€‚

`set_model_attributes` æ–¹æ³•ç”¨äºè®¾ç½®æ¨¡å‹çš„å±æ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œç±»åˆ«åç§°ï¼Œä»¥ä¾¿æ¨¡å‹èƒ½å¤Ÿæ­£ç¡®å¤„ç†æ•°æ®ã€‚

`get_model` æ–¹æ³•è¿”å›ä¸€ä¸ª YOLO æ£€æµ‹æ¨¡å‹å®ä¾‹ï¼Œå¹¶å¯é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚

`get_validator` æ–¹æ³•è¿”å›ä¸€ä¸ªç”¨äºéªŒè¯æ¨¡å‹æ€§èƒ½çš„ `DetectionValidator` å®ä¾‹ï¼Œèƒ½å¤Ÿåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è¯„ä¼°æ¨¡å‹çš„æ•ˆæœã€‚

`label_loss_items` æ–¹æ³•ç”¨äºè¿”å›å¸¦æœ‰æ ‡ç­¾çš„è®­ç»ƒæŸå¤±é¡¹å­—å…¸ï¼Œæ–¹ä¾¿åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è®°å½•å’Œç›‘æ§æŸå¤±ã€‚

`progress_string` æ–¹æ³•ç”Ÿæˆä¸€ä¸ªæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ï¼Œç”¨äºæ˜¾ç¤ºè®­ç»ƒè¿›åº¦ï¼ŒåŒ…æ‹¬å½“å‰çš„ epochã€GPU å†…å­˜ä½¿ç”¨æƒ…å†µã€æŸå¤±å€¼ã€å®ä¾‹æ•°é‡å’Œå›¾åƒå¤§å°ç­‰ä¿¡æ¯ã€‚

`plot_training_samples` æ–¹æ³•ç”¨äºç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ ‡æ³¨ï¼Œå¸®åŠ©å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ•°æ®ã€‚

æœ€åï¼Œ`plot_metrics` å’Œ `plot_training_labels` æ–¹æ³•åˆ†åˆ«ç”¨äºç»˜åˆ¶è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŒ‡æ ‡å’Œåˆ›å»ºå¸¦æ ‡ç­¾çš„è®­ç»ƒå›¾ï¼Œä¾¿äºåˆ†ææ¨¡å‹çš„è®­ç»ƒæ•ˆæœã€‚

æ•´ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„æ¡†æ¶ï¼Œæ”¯æŒ YOLO æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®å¤„ç†ã€æ¨¡å‹æ„å»ºã€è®­ç»ƒç›‘æ§å’Œç»“æœå¯è§†åŒ–ç­‰åŠŸèƒ½ã€‚

#### 11.6 val.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼Œä¸»è¦ä¿ç•™äº† YOLO æ¨¡å‹çš„éªŒè¯é€»è¾‘åŠå…¶ç›¸å…³åŠŸèƒ½ï¼š

```python
import os
import torch
from ultralytics.engine.validator import BaseValidator
from ultralytics.utils import LOGGER, ops
from ultralytics.utils.metrics import ConfusionMatrix, DetMetrics, box_iou

class DetectionValidator(BaseValidator):
    """
    ç»§æ‰¿è‡ª BaseValidator çš„æ£€æµ‹æ¨¡å‹éªŒè¯ç±»ã€‚
    ç”¨äºéªŒè¯ YOLO æ¨¡å‹çš„æ€§èƒ½ã€‚
    """

    def __init__(self, dataloader=None, save_dir=None, args=None):
        """åˆå§‹åŒ–æ£€æµ‹æ¨¡å‹æ‰€éœ€çš„å˜é‡å’Œè®¾ç½®ã€‚"""
        super().__init__(dataloader, save_dir, args)
        self.metrics = DetMetrics(save_dir=self.save_dir)  # åˆå§‹åŒ–æ£€æµ‹æŒ‡æ ‡
        self.confusion_matrix = ConfusionMatrix(nc=len(args.names), conf=args.conf)  # åˆå§‹åŒ–æ··æ·†çŸ©é˜µ

    def preprocess(self, batch):
        """é¢„å¤„ç†å›¾åƒæ‰¹æ¬¡ä»¥é€‚åº” YOLO æ¨¡å‹ã€‚"""
        batch["img"] = batch["img"].to(self.device) / 255  # å°†å›¾åƒå½’ä¸€åŒ–
        for k in ["batch_idx", "cls", "bboxes"]:
            batch[k] = batch[k].to(self.device)  # å°†æ ‡ç­¾å’Œè¾¹ç•Œæ¡†ç§»åŠ¨åˆ°è®¾å¤‡ä¸Š
        return batch

    def postprocess(self, preds):
        """å¯¹é¢„æµ‹ç»“æœåº”ç”¨éæå¤§å€¼æŠ‘åˆ¶ï¼ˆNMSï¼‰ã€‚"""
        return ops.non_max_suppression(
            preds,
            self.args.conf,
            self.args.iou,
            multi_label=True,
            max_det=self.args.max_det,
        )

    def update_metrics(self, preds, batch):
        """æ›´æ–°æ£€æµ‹æŒ‡æ ‡ã€‚"""
        for si, pred in enumerate(preds):
            npr = len(pred)  # å½“å‰é¢„æµ‹çš„æ•°é‡
            pbatch = self._prepare_batch(si, batch)  # å‡†å¤‡å½“å‰æ‰¹æ¬¡çš„æ•°æ®
            cls, bbox = pbatch.pop("cls"), pbatch.pop("bbox")  # è·å–çœŸå®æ ‡ç­¾
            if npr == 0:
                continue  # å¦‚æœæ²¡æœ‰é¢„æµ‹ï¼Œè·³è¿‡
            
            predn = self._prepare_pred(pred, pbatch)  # å‡†å¤‡é¢„æµ‹æ•°æ®
            stat = {
                "conf": predn[:, 4],  # ç½®ä¿¡åº¦
                "pred_cls": predn[:, 5],  # é¢„æµ‹ç±»åˆ«
                "tp": self._process_batch(predn, bbox, cls)  # è®¡ç®—çœŸé˜³æ€§
            }
            self.stats["tp"].append(stat["tp"])  # æ›´æ–°ç»Ÿè®¡ä¿¡æ¯

    def _process_batch(self, detections, gt_bboxes, gt_cls):
        """è¿”å›æ­£ç¡®é¢„æµ‹çŸ©é˜µã€‚"""
        iou = box_iou(gt_bboxes, detections[:, :4])  # è®¡ç®— IoU
        return self.match_predictions(detections[:, 5], gt_cls, iou)  # åŒ¹é…é¢„æµ‹ä¸çœŸå®æ ‡ç­¾

    def get_stats(self):
        """è¿”å›æŒ‡æ ‡ç»Ÿè®¡ä¿¡æ¯å’Œç»“æœå­—å…¸ã€‚"""
        stats = {k: torch.cat(v, 0).cpu().numpy() for k, v in self.stats.items()}  # è½¬æ¢ä¸º numpy
        if len(stats) and stats["tp"].any():
            self.metrics.process(**stats)  # å¤„ç†æŒ‡æ ‡
        return self.metrics.results_dict  # è¿”å›ç»“æœå­—å…¸

    def print_results(self):
        """æ‰“å°æ¯ä¸ªç±»åˆ«çš„è®­ç»ƒ/éªŒè¯é›†æŒ‡æ ‡ã€‚"""
        pf = "%22s" + "%11i" * 2 + "%11.3g" * len(self.metrics.keys)  # æ‰“å°æ ¼å¼
        LOGGER.info(pf % ("all", self.seen, self.nt_per_class.sum(), *self.metrics.mean_results()))  # æ‰“å°æ€»ç»“æœ
```

### ä»£ç è¯´æ˜ï¼š
1. **DetectionValidator ç±»**ï¼šè¿™æ˜¯ä¸€ä¸ªç”¨äºéªŒè¯ YOLO æ¨¡å‹çš„ç±»ï¼Œç»§æ‰¿è‡ª `BaseValidator`ã€‚
2. **åˆå§‹åŒ–æ–¹æ³• `__init__`**ï¼šè®¾ç½®å¿…è¦çš„å˜é‡å’ŒæŒ‡æ ‡ï¼ŒåŒ…æ‹¬æ£€æµ‹æŒ‡æ ‡å’Œæ··æ·†çŸ©é˜µã€‚
3. **é¢„å¤„ç†æ–¹æ³• `preprocess`**ï¼šå¯¹è¾“å…¥çš„å›¾åƒæ‰¹æ¬¡è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œå¹¶å°†æ•°æ®ç§»åŠ¨åˆ°æŒ‡å®šè®¾å¤‡ä¸Šã€‚
4. **åå¤„ç†æ–¹æ³• `postprocess`**ï¼šåº”ç”¨éæå¤§å€¼æŠ‘åˆ¶ï¼ˆNMSï¼‰æ¥è¿‡æ»¤æ‰é‡å çš„é¢„æµ‹æ¡†ã€‚
5. **æ›´æ–°æŒ‡æ ‡æ–¹æ³• `update_metrics`**ï¼šæ›´æ–°å½“å‰æ‰¹æ¬¡çš„æ£€æµ‹æŒ‡æ ‡ï¼ŒåŒ…æ‹¬è®¡ç®—çœŸé˜³æ€§ï¼ˆTPï¼‰ã€‚
6. **å¤„ç†æ‰¹æ¬¡æ–¹æ³• `_process_batch`**ï¼šè®¡ç®—é¢„æµ‹æ¡†ä¸çœŸå®æ¡†ä¹‹é—´çš„ IoUï¼Œå¹¶åŒ¹é…é¢„æµ‹ä¸çœŸå®æ ‡ç­¾ã€‚
7. **è·å–ç»Ÿè®¡ä¿¡æ¯æ–¹æ³• `get_stats`**ï¼šè¿”å›å½“å‰çš„æŒ‡æ ‡ç»Ÿè®¡ä¿¡æ¯å’Œç»“æœå­—å…¸ã€‚
8. **æ‰“å°ç»“æœæ–¹æ³• `print_results`**ï¼šæ‰“å°æ¯ä¸ªç±»åˆ«çš„è®­ç»ƒå’ŒéªŒè¯é›†çš„æŒ‡æ ‡ç»“æœã€‚

ä»¥ä¸Šæ˜¯ YOLO æ¨¡å‹éªŒè¯çš„æ ¸å¿ƒé€»è¾‘ï¼Œæ³¨é‡Šè¯¦ç»†è§£é‡Šäº†æ¯ä¸ªæ–¹æ³•çš„åŠŸèƒ½å’Œä½œç”¨ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `val.py` æ˜¯ä¸€ä¸ªç”¨äºéªŒè¯åŸºäº YOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„ç±»ï¼Œåä¸º `DetectionValidator`ã€‚è¯¥ç±»ç»§æ‰¿è‡ª `BaseValidator`ï¼Œä¸»è¦ç”¨äºå¤„ç†æ¨¡å‹çš„éªŒè¯è¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®é¢„å¤„ç†ã€æŒ‡æ ‡è®¡ç®—ã€ç»“æœè¾“å‡ºç­‰ã€‚

åœ¨åˆå§‹åŒ–æ–¹æ³•ä¸­ï¼Œ`DetectionValidator` è®¾ç½®äº†ä¸€äº›å¿…è¦çš„å˜é‡å’Œå‚æ•°ï¼ŒåŒ…æ‹¬æ•°æ®åŠ è½½å™¨ã€ä¿å­˜ç›®å½•ã€è¿›åº¦æ¡ã€å‚æ•°å­—å…¸ç­‰ã€‚å®ƒè¿˜å®šä¹‰äº†ä¸€äº›ç”¨äºè®¡ç®—æŒ‡æ ‡çš„å˜é‡ï¼Œå¦‚æ¯ä¸ªç±»åˆ«çš„ç›®æ ‡æ•°é‡ã€æ˜¯å¦ä½¿ç”¨ COCO æ•°æ®é›†ã€ç±»åˆ«æ˜ å°„ç­‰ã€‚åˆå§‹åŒ–æ—¶ï¼Œ`DetMetrics` ç±»è¢«ç”¨æ¥è®¡ç®—æ£€æµ‹æŒ‡æ ‡ï¼Œå¹¶å®šä¹‰äº†ä¸€ä¸ª IoUï¼ˆIntersection over Unionï¼‰å‘é‡ï¼Œç”¨äºåç»­çš„ mAPï¼ˆmean Average Precisionï¼‰è®¡ç®—ã€‚

`preprocess` æ–¹æ³•è´Ÿè´£å¯¹è¾“å…¥çš„å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å°†å›¾åƒæ•°æ®è½¬ç§»åˆ°æŒ‡å®šè®¾å¤‡ï¼ˆå¦‚ GPUï¼‰ï¼Œè¿›è¡Œæ•°æ®ç±»å‹è½¬æ¢ï¼Œå¹¶å½’ä¸€åŒ–å¤„ç†ã€‚è¯¥æ–¹æ³•è¿˜ä¼šæ ¹æ®è®¾ç½®ä¿å­˜ç”¨äºè‡ªåŠ¨æ ‡æ³¨çš„è¾¹ç•Œæ¡†ä¿¡æ¯ã€‚

`init_metrics` æ–¹æ³•ç”¨äºåˆå§‹åŒ–éªŒè¯æŒ‡æ ‡ï¼Œåˆ¤æ–­æ•°æ®é›†æ˜¯å¦ä¸º COCO æ ¼å¼ï¼Œå¹¶æ ¹æ®æ¨¡å‹çš„ç±»åˆ«åç§°è®¾ç½®ç›¸å…³çš„æŒ‡æ ‡ã€‚

`get_desc` æ–¹æ³•è¿”å›ä¸€ä¸ªæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ï¼Œç”¨äºæè¿° YOLO æ¨¡å‹çš„ç±»åˆ«æŒ‡æ ‡ã€‚

`postprocess` æ–¹æ³•åº”ç”¨éæå¤§å€¼æŠ‘åˆ¶ï¼ˆNMSï¼‰æ¥å¤„ç†æ¨¡å‹çš„é¢„æµ‹è¾“å‡ºï¼Œä»¥å‡å°‘å†—ä½™çš„è¾¹ç•Œæ¡†ã€‚

`_prepare_batch` å’Œ `_prepare_pred` æ–¹æ³•åˆ†åˆ«ç”¨äºå‡†å¤‡è¾“å…¥æ‰¹æ¬¡å’Œé¢„æµ‹ç»“æœï¼Œä»¥ä¾¿è¿›è¡Œåç»­çš„è¯„ä¼°ã€‚

`update_metrics` æ–¹æ³•è´Ÿè´£æ›´æ–°æ¨¡å‹çš„è¯„ä¼°æŒ‡æ ‡ï¼ŒåŒ…æ‹¬å¤„ç†æ¯ä¸ªæ‰¹æ¬¡çš„é¢„æµ‹ç»“æœå’ŒçœŸå®æ ‡ç­¾ï¼Œå¹¶æ ¹æ®è®¾ç½®ä¿å­˜ç»“æœåˆ° JSON æˆ– TXT æ–‡ä»¶ä¸­ã€‚

`finalize_metrics` æ–¹æ³•åœ¨æ‰€æœ‰éªŒè¯å®Œæˆåè®¾ç½®æœ€ç»ˆçš„æŒ‡æ ‡å€¼ï¼ŒåŒ…æ‹¬é€Ÿåº¦å’Œæ··æ·†çŸ©é˜µã€‚

`get_stats` æ–¹æ³•è¿”å›è®¡ç®—åçš„æŒ‡æ ‡ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…å«æ¯ä¸ªç±»åˆ«çš„ç›®æ ‡æ•°é‡ã€‚

`print_results` æ–¹æ³•æ‰“å°è®­ç»ƒæˆ–éªŒè¯é›†çš„æ¯ä¸ªç±»åˆ«çš„æŒ‡æ ‡ï¼ŒåŒ…æ‹¬å›¾åƒæ•°é‡ã€å®ä¾‹æ•°é‡å’Œå„ç±»æŒ‡æ ‡çš„å¹³å‡å€¼ã€‚

`_process_batch` æ–¹æ³•è®¡ç®—æ­£ç¡®é¢„æµ‹çš„çŸ©é˜µï¼Œè¿”å›æ¯ä¸ªé¢„æµ‹ä¸çœŸå®æ ‡ç­¾çš„åŒ¹é…æƒ…å†µã€‚

`build_dataset` å’Œ `get_dataloader` æ–¹æ³•ç”¨äºæ„å»º YOLO æ•°æ®é›†å’Œè¿”å›æ•°æ®åŠ è½½å™¨ï¼Œæ”¯æŒä¸åŒçš„æ‰¹æ¬¡å¤§å°å’Œæ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰ã€‚

`plot_val_samples` å’Œ `plot_predictions` æ–¹æ³•ç”¨äºç»˜åˆ¶éªŒè¯æ ·æœ¬å’Œé¢„æµ‹ç»“æœï¼Œå¹¶å°†ç»“æœä¿å­˜ä¸ºå›¾åƒæ–‡ä»¶ã€‚

`save_one_txt` æ–¹æ³•å°† YOLO æ£€æµ‹ç»“æœä¿å­˜ä¸º TXT æ–‡ä»¶ï¼Œæ ¼å¼ä¸ºå½’ä¸€åŒ–åæ ‡ã€‚

`pred_to_json` æ–¹æ³•å°† YOLO çš„é¢„æµ‹ç»“æœåºåˆ—åŒ–ä¸º COCO JSON æ ¼å¼ï¼Œä»¥ä¾¿åç»­è¯„ä¼°ã€‚

`eval_json` æ–¹æ³•è¯„ä¼°ä»¥ JSON æ ¼å¼ä¿å­˜çš„ YOLO è¾“å‡ºï¼Œå¹¶è¿”å›æ€§èƒ½ç»Ÿè®¡ä¿¡æ¯ï¼Œæ”¯æŒä½¿ç”¨ pycocotools è®¡ç®— mAPã€‚

æ•´ä½“æ¥çœ‹ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„æ¡†æ¶ï¼Œç”¨äºéªŒè¯ YOLO æ¨¡å‹çš„æ€§èƒ½ï¼Œæ”¯æŒå¤šç§è¾“å‡ºæ ¼å¼å’ŒæŒ‡æ ‡è®¡ç®—ï¼Œé€‚ç”¨äºç›®æ ‡æ£€æµ‹ä»»åŠ¡çš„è¯„ä¼°ã€‚

### 12.ç³»ç»Ÿæ•´ä½“ç»“æ„ï¼ˆèŠ‚é€‰ï¼‰

### æ•´ä½“åŠŸèƒ½å’Œæ„æ¶æ¦‚æ‹¬

è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç›®æ ‡æ£€æµ‹æ¡†æ¶ï¼ŒåŸºäº YOLOv8 æ¨¡å‹ï¼Œæ—¨åœ¨æä¾›é«˜æ•ˆçš„è®­ç»ƒã€éªŒè¯å’Œæ¨ç†åŠŸèƒ½ã€‚å®ƒåŒ…æ‹¬å¤šä¸ªæ¨¡å—ï¼Œæ¶µç›–äº†ä»æ•°æ®å¤„ç†ã€æ¨¡å‹æ„å»ºã€è®­ç»ƒè¿‡ç¨‹åˆ°ç»“æœè¯„ä¼°çš„å„ä¸ªæ–¹é¢ã€‚æ•´ä½“æ¶æ„åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªä¸»è¦éƒ¨åˆ†ï¼š

1. **æ¨¡å‹å®šä¹‰**ï¼šåŒ…æ‹¬ YOLOv8 å’Œ NASï¼ˆNeural Architecture Searchï¼‰æ¨¡å‹çš„å®ç°ï¼Œè´Ÿè´£æ¨¡å‹çš„æ„å»ºå’Œæƒé‡åŠ è½½ã€‚
2. **æ•°æ®å¤„ç†**ï¼šåŒ…æ‹¬æ•°æ®é›†çš„æ„å»ºã€æ•°æ®åŠ è½½å’Œé¢„å¤„ç†ï¼Œç¡®ä¿è¾“å…¥æ•°æ®çš„è´¨é‡å’Œæ ¼å¼ç¬¦åˆæ¨¡å‹è¦æ±‚ã€‚
3. **è®­ç»ƒå’ŒéªŒè¯**ï¼šæä¾›è®­ç»ƒå’ŒéªŒè¯çš„åŠŸèƒ½ï¼Œæ”¯æŒæŸå¤±è®¡ç®—ã€æŒ‡æ ‡è¯„ä¼°å’Œç»“æœå¯è§†åŒ–ã€‚
4. **æ¨ç†å’Œå¯è§†åŒ–**ï¼šæ”¯æŒå¯¹æ–°å›¾åƒè¿›è¡Œæ¨ç†ï¼Œå¹¶å°†ç»“æœå¯è§†åŒ–ï¼Œæ–¹ä¾¿ç”¨æˆ·ç†è§£æ¨¡å‹çš„è¾“å‡ºã€‚
5. **å·¥å…·å’Œå®ç”¨å‡½æ•°**ï¼šæä¾›å„ç§å®ç”¨å·¥å…·å‡½æ•°ï¼Œå¸®åŠ©ç®€åŒ–å¸¸è§æ“ä½œï¼Œå¦‚è¾¹ç•Œæ¡†å¤„ç†ã€ç»“æœä¿å­˜ç­‰ã€‚

### æ–‡ä»¶åŠŸèƒ½æ•´ç†è¡¨

| æ–‡ä»¶è·¯å¾„                                                                                         | åŠŸèƒ½æè¿°                                                                                   |
|--------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------|
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\models\nas\model.py`       | å®šä¹‰ YOLO-NAS æ¨¡å‹ç±»ï¼Œè´Ÿè´£æ¨¡å‹çš„æ„å»ºå’Œæƒé‡åŠ è½½ã€‚                                           |
| `code\ultralytics\utils\instance.py`                                                           | å®šä¹‰ `Bboxes` å’Œ `Instances` ç±»ï¼Œç”¨äºå¤„ç†è¾¹ç•Œæ¡†åŠå…¶ç›¸å…³ä¿¡æ¯ï¼Œæ”¯æŒå¤šç§æ ¼å¼å’Œæ“ä½œã€‚         |
| `ui.py`                                                                                         | é€šè¿‡ Streamlit å¯åŠ¨ Web åº”ç”¨ï¼Œæä¾›ä¸€ä¸ªç®€å•çš„æ¥å£æ¥è¿è¡Œç›®æ ‡æ£€æµ‹è„šæœ¬ã€‚                       |
| `code\ultralytics\models\fastsam\prompt.py`                                                    | å®šä¹‰ `FastSAMPrompt` ç±»ï¼Œå¤„ç†å›¾åƒæ³¨é‡Šå’Œå¯è§†åŒ–ï¼Œæ”¯æŒä¸ç”¨æˆ·äº¤äº’çš„åˆ†å‰²å’Œæ£€æµ‹åŠŸèƒ½ã€‚           |
| `train.py`                                                                                      | å®šä¹‰ `DetectionTrainer` ç±»ï¼Œè´Ÿè´£ YOLO æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®å¤„ç†ã€æ¨¡å‹è®¾ç½®å’Œç›‘æ§ã€‚     |
| `val.py`                                                                                        | å®šä¹‰ `DetectionValidator` ç±»ï¼Œè´Ÿè´£éªŒè¯æ¨¡å‹æ€§èƒ½ï¼ŒåŒ…æ‹¬æŒ‡æ ‡è®¡ç®—å’Œç»“æœè¾“å‡ºã€‚                 |
| `predict.py`                                                                                     | æä¾›æ¨ç†åŠŸèƒ½ï¼Œä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹å¯¹æ–°å›¾åƒè¿›è¡Œç›®æ ‡æ£€æµ‹å¹¶è¾“å‡ºç»“æœã€‚                           |
| `code\ultralytics\hub\utils.py`                                                                | æä¾›ä¸æ¨¡å‹ä»“åº“ç›¸å…³çš„å®ç”¨å·¥å…·å‡½æ•°ï¼Œæ”¯æŒæ¨¡å‹çš„åŠ è½½å’Œç®¡ç†ã€‚                                 |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\nn\extra_modules\ops_dcnv3\functions\__init__.py` | å®šä¹‰ DCNv3ï¼ˆDeformable Convolution v3ï¼‰ç›¸å…³çš„å‡½æ•°å’Œæ¨¡å—ï¼Œæ”¯æŒæ¨¡å‹çš„çµæ´»æ€§å’Œæ‰©å±•æ€§ã€‚     |
| `code\ultralytics\utils\__init__.py`                                                          | åˆå§‹åŒ– `utils` æ¨¡å—ï¼Œå¯¼å…¥å¸¸ç”¨çš„å·¥å…·å‡½æ•°å’Œç±»ã€‚                                             |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\utils\checks.py`         | æä¾›æ£€æŸ¥å’ŒéªŒè¯åŠŸèƒ½ï¼Œç¡®ä¿è¾“å…¥æ•°æ®å’Œæ¨¡å‹çš„æœ‰æ•ˆæ€§ã€‚                                         |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\nn\modules\conv.py`     | å®šä¹‰å·ç§¯å±‚åŠå…¶å˜ç§ï¼Œæ”¯æŒæ¨¡å‹çš„æ„å»ºå’Œä¼˜åŒ–ã€‚                                               |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\utils\benchmarks.py`   | æä¾›åŸºå‡†æµ‹è¯•åŠŸèƒ½ï¼Œç”¨äºè¯„ä¼°æ¨¡å‹çš„æ€§èƒ½å’Œé€Ÿåº¦ã€‚                                             |

è¿™ä¸ªè¡¨æ ¼æ€»ç»“äº†é¡¹ç›®ä¸­å„ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½ï¼Œå¸®åŠ©ç†è§£æ•´ä¸ªç›®æ ‡æ£€æµ‹æ¡†æ¶çš„æ„æˆå’Œä½œç”¨ã€‚

æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰â€ä¸­éƒ¨åˆ†ä»£ç å¯èƒ½ä¼šä¼˜åŒ–å‡çº§ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ï¼Œå®Œæ•´â€œè®­ç»ƒæºç â€ã€â€œWebå‰ç«¯ç•Œé¢â€å’Œâ€œ70+ç§åˆ›æ–°ç‚¹æºç â€ä»¥â€œ13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–â€çš„å†…å®¹ä¸ºå‡†ã€‚

### 13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–

![19.png](19.png)


# [ä¸‹è½½é“¾æ¥ï¼šhttps://mbd.pub/o/bread/ZpuZmZ9w](https://mbd.pub/o/bread/ZpuZmZ9w)